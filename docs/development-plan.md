# ğŸ“‹ Maycast Recorder é–‹ç™ºè¨ˆç”»

## Overview

æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€Maycast Recorderã®æ®µéšçš„ãªé–‹ç™ºè¨ˆç”»ã‚’å®šç¾©ã—ã¾ã™ã€‚å„ãƒ•ã‚§ãƒ¼ã‚ºã¯ç‹¬ç«‹ã—ã¦å‹•ä½œå¯èƒ½ãªçŠ¶æ…‹ã‚’ç›®æŒ‡ã—ã€æ®µéšçš„ã«æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¦ã„ãã¾ã™ã€‚

---

## Phase 1A: ã‚³ã‚¢éŒ²ç”»æ©Ÿèƒ½ + ãƒãƒ£ãƒ³ã‚¯æ¤œè¨¼ ğŸ¯

**Goal:** fMP4ãƒãƒ£ãƒ³ã‚¯ç”Ÿæˆãƒ»OPFSä¿å­˜ãƒ»å€‹åˆ¥ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆãƒ†ã‚¹ãƒˆç”¨ï¼‰ã‚’å®Ÿè£…

**Concept:**
- WebCodecs â†’ WASM Muxer â†’ OPFS ã®åŸºæœ¬ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’ç¢ºç«‹
- å„æ®µéšã§ç‹¬ç«‹ã—ã¦ãƒ†ã‚¹ãƒˆãƒ»æ¤œè¨¼ã§ãã‚‹ã‚ˆã†ã«ç´°åˆ†åŒ–
- å€‹åˆ¥ãƒãƒ£ãƒ³ã‚¯ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã€fMP4ãŒæ­£ã—ãç”Ÿæˆã•ã‚Œã¦ã„ã‚‹ã‹æ¤œè¨¼å¯èƒ½ã«ã™ã‚‹

---

### Phase 1A-1: ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

**Goal:** ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåŸºç›¤ã‚’æ§‹ç¯‰ã—ã€åŸºæœ¬çš„ãªå‹•ä½œç¢ºèª

```text
/maycast-recorder
â”œâ”€â”€ Cargo.toml           # Workspace root
â”œâ”€â”€ /packages
â”‚   â”œâ”€â”€ /common          # å…±é€šå‹å®šç¾©
â”‚   â”œâ”€â”€ /wasm-core       # Rust -> WASM Muxing
â”‚   â””â”€â”€ /web-client      # TypeScript Frontend
â””â”€â”€ /docs
```

**Tasks:**
- [ ] Cargo Workspaceè¨­å®š
- [ ] common crateã®ä½œæˆï¼ˆChunkID, MetadataåŸºæœ¬å‹ï¼‰
- [ ] wasm-core crateã®ä½œæˆï¼ˆwasm-bindgenè¨­å®šï¼‰
- [ ] web-client scaffoldingï¼ˆVite + React + Tailwind CSSï¼‰
- [ ] WASM ãƒ“ãƒ«ãƒ‰ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­å®šï¼ˆwasm-packï¼‰
- [ ] Vite ã‹ã‚‰ WASM ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã§ãã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] **Taskfile.yml ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—**
  - å…¨ã¦ã®é–‹ç™ºã‚³ãƒãƒ³ãƒ‰ã‚’Taskfileã«é›†ç´„
  - `task --list` ã§åˆ©ç”¨å¯èƒ½ãªã‚³ãƒãƒ³ãƒ‰ä¸€è¦§ã‚’è¡¨ç¤º

**Taskfile ã‚³ãƒãƒ³ãƒ‰ä¾‹:**
```yaml
# task build:wasm     - WASM ã‚’ãƒ“ãƒ«ãƒ‰
# task build:client   - Vite ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ãƒ“ãƒ«ãƒ‰
# task dev            - é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•ï¼ˆWASMè‡ªå‹•ãƒªãƒ“ãƒ«ãƒ‰ + Viteï¼‰
# task test:rust      - Rustå˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
# task clean          - ãƒ“ãƒ«ãƒ‰æˆæœç‰©å‰Šé™¤
```

**Test:**
- [ ] `task --list` ã§ã‚¿ã‚¹ã‚¯ä¸€è¦§ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] `task build:wasm` ãŒæˆåŠŸã™ã‚‹ï¼ˆ= `wasm-pack build` ç›¸å½“ï¼‰
- [ ] `task dev` ã§é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ãŒèµ·å‹•ã—ã€Hello World ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ WASM é–¢æ•°ã‚’å‘¼ã³å‡ºã›ã‚‹ï¼ˆä¾‹: `add(1, 2)` â†’ `3`ï¼‰

---

### Phase 1A-2: WebCodecs ã‚«ãƒ¡ãƒ©ã‚­ãƒ£ãƒ—ãƒãƒ£å˜ä½“

**Goal:** ã‚«ãƒ¡ãƒ©æ˜ åƒãƒ»éŸ³å£°ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã¾ã§ã‚’å˜ä½“ã§å‹•ä½œã•ã›ã‚‹

**Tasks:**
- [ ] `getUserMedia()` ã§ã‚«ãƒ¡ãƒ©/ãƒã‚¤ã‚¯å–å¾—
- [ ] ã‚«ãƒ¡ãƒ©ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤ºï¼ˆvideoè¦ç´ ï¼‰
- [ ] VideoEncoderåˆæœŸåŒ–ï¼ˆH.264, 1ç§’ã”ã¨Keyframeå¼·åˆ¶ï¼‰
- [ ] AudioEncoderåˆæœŸåŒ–ï¼ˆAACï¼‰
- [ ] EncodedVideoChunk/AudioChunkå–å¾—ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
- [ ] ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰æ¸ˆã¿ãƒãƒ£ãƒ³ã‚¯ã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›

**UI:**
- [ ] ã‚«ãƒ¡ãƒ©ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
- [ ] éŒ²ç”»é–‹å§‹/åœæ­¢ãƒœã‚¿ãƒ³
- [ ] ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ãƒãƒ£ãƒ³ã‚¯æ•°ã®ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼è¡¨ç¤º

**Test:**
- [ ] ã‚«ãƒ¡ãƒ©æ˜ åƒãŒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«è¡¨ç¤ºã•ã‚Œã‚‹
- [ ] éŒ²ç”»é–‹å§‹æ™‚ã€EncodedVideoChunk ãŒã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›ã•ã‚Œã‚‹
- [ ] éŒ²ç”»é–‹å§‹æ™‚ã€EncodedAudioChunk ãŒã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›ã•ã‚Œã‚‹
- [ ] 1ç§’ã”ã¨ã«ã‚­ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ ãŒç”Ÿæˆã•ã‚Œã‚‹ï¼ˆchunk.type === "key"ï¼‰

---

### Phase 1A-3: Rust WASM Muxer å˜ä½“

**Goal:** fMP4ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯ã‚’ Rust å˜ä½“ã§ãƒ†ã‚¹ãƒˆå¯èƒ½ã«ã™ã‚‹

**Dependencies:**
- `mp4` crateï¼ˆfMP4ç”Ÿæˆï¼‰
- `wasm-bindgen`

**Tasks:**
- [ ] `MuxerState` æ§‹é€ ä½“å®šç¾©
- [ ] `init()`: fMP4ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆftyp, moovï¼‰ç”Ÿæˆ
- [ ] `push_video_chunk(data: &[u8], timestamp: u64, is_key: bool)`: moof + mdatç”Ÿæˆ
- [ ] `push_audio_chunk(data: &[u8], timestamp: u64)`: åŒä¸Š
- [ ] `get_fragment() -> Vec<u8>`: å®Œæˆã—ãŸfMP4æ–­ç‰‡ã‚’è¿”ã™
- [ ] Rustå˜ä½“ãƒ†ã‚¹ãƒˆä½œæˆï¼ˆãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã§fMP4ç”Ÿæˆï¼‰

**Test:**
- [ ] Rustã® `cargo test` ã§fMP4ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯ãŒå‹•ä½œã™ã‚‹
- [ ] ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ç”Ÿæˆã•ã‚ŒãŸfMP4ã‚’ `mp4info` ã‚³ãƒãƒ³ãƒ‰ã§æ¤œè¨¼ã§ãã‚‹
- [ ] WASMãƒ“ãƒ«ãƒ‰å¾Œã€ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰å‘¼ã³å‡ºã›ã‚‹

---

### Phase 1A-4: WebCodecs + WASM çµ±åˆ

**Goal:** WebCodecs ã®å‡ºåŠ›ã‚’ WASM Muxer ã«æ¸¡ã—ã€fMP4ãƒãƒ£ãƒ³ã‚¯ã‚’ç”Ÿæˆ

**Tasks:**
- [ ] EncodedVideoChunk â†’ WASM `push_video_chunk()` é€£æº
- [ ] EncodedAudioChunk â†’ WASM `push_audio_chunk()` é€£æº
- [ ] å®šæœŸçš„ã« `get_fragment()` ã‚’å‘¼ã³å‡ºã—ã¦fMP4æ–­ç‰‡å–å¾—
- [ ] ç”Ÿæˆã•ã‚ŒãŸfMP4ãƒãƒ£ãƒ³ã‚¯ã‚’Blobã«å¤‰æ›
- [ ] Blobã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ› or ä¸€æ™‚çš„ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

**UI:**
- [ ] Phase 1A-2 ã®UIã«åŠ ãˆã¦
- [ ] ç”Ÿæˆã•ã‚ŒãŸfMP4ãƒãƒ£ãƒ³ã‚¯æ•°ã®è¡¨ç¤º
- [ ] ã€Œæœ€æ–°ãƒãƒ£ãƒ³ã‚¯ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã€ãƒœã‚¿ãƒ³ï¼ˆãƒ†ã‚¹ãƒˆç”¨ï¼‰

**Test:**
- [ ] éŒ²ç”»ä¸­ã€å®šæœŸçš„ã«fMP4ãƒãƒ£ãƒ³ã‚¯ãŒç”Ÿæˆã•ã‚Œã‚‹
- [ ] ç”Ÿæˆã•ã‚ŒãŸãƒãƒ£ãƒ³ã‚¯ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã€VLCç­‰ã§å†ç”Ÿã§ãã‚‹
- [ ] å‹•ç”»ã¨éŸ³å£°ãŒæ­£ã—ãåŒæœŸã—ã¦ã„ã‚‹

---

### Phase 1A-5: OPFS ä¿å­˜æ©Ÿèƒ½

**Goal:** ç”Ÿæˆã•ã‚ŒãŸfMP4ãƒãƒ£ãƒ³ã‚¯ã‚’OPFSã«ä¿å­˜ãƒ»èª­ã¿å‡ºã—

**Tasks:**
- [ ] OPFS APIãƒ©ãƒƒãƒ‘ãƒ¼å®Ÿè£…ï¼ˆTypeScriptï¼‰
- [ ] `writeChunk(sessionId, chunkId, data: Uint8Array)` å®Ÿè£…
- [ ] `readChunk(sessionId, chunkId)` å®Ÿè£…
- [ ] `listChunks(sessionId)` å®Ÿè£…ï¼ˆå¾©æ—§ç”¨ï¼‰
- [ ] IndexedDBã§ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ç®¡ç†ï¼ˆchunk index, timestamp, size, blake3 hashï¼‰
- [ ] Phase 1A-4 ã§ç”Ÿæˆã—ãŸãƒãƒ£ãƒ³ã‚¯ã‚’OPFSã«è‡ªå‹•ä¿å­˜

**UI:**
- [ ] Phase 1A-4 ã®UIã«åŠ ãˆã¦
- [ ] OPFSä¿å­˜çŠ¶æ…‹ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼
- [ ] ä¿å­˜æ¸ˆã¿ãƒãƒ£ãƒ³ã‚¯ä¸€è¦§è¡¨ç¤º

**Test:**
- [ ] éŒ²ç”»ä¸­ã€ãƒãƒ£ãƒ³ã‚¯ãŒOPFSã«ä¿å­˜ã•ã‚Œã‚‹
- [ ] ãƒ–ãƒ©ã‚¦ã‚¶ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦ã‚‚ã€ä¿å­˜ã•ã‚ŒãŸãƒãƒ£ãƒ³ã‚¯ãŒæ®‹ã£ã¦ã„ã‚‹
- [ ] `listChunks()` ã§ä¿å­˜æ¸ˆã¿ãƒãƒ£ãƒ³ã‚¯ãŒä¸€è¦§è¡¨ç¤ºã•ã‚Œã‚‹
- [ ] IndexedDBã«ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãè¨˜éŒ²ã•ã‚Œã‚‹

---

### Phase 1A-6: ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ + ãƒãƒ£ãƒ³ã‚¯æ¤œè¨¼

**Goal:** éŒ²ç”»â†’OPFSä¿å­˜â†’å€‹åˆ¥ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã®å…¨ä½“ãƒ•ãƒ­ãƒ¼ã‚’å®Œæˆ

**Tasks:**
- [ ] ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†æ©Ÿèƒ½ï¼ˆsessionIdç”Ÿæˆã€ã‚»ãƒƒã‚·ãƒ§ãƒ³çŠ¶æ…‹ç®¡ç†ï¼‰
- [ ] `downloadChunk(sessionId, chunkId)` é–¢æ•°å®Ÿè£…
- [ ] OPFS ã‹ã‚‰ãƒãƒ£ãƒ³ã‚¯ã‚’èª­ã¿å‡ºã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
- [ ] çµŒéæ™‚é–“ã‚¿ã‚¤ãƒãƒ¼è¡¨ç¤º
- [ ] éŒ²ç”»é–‹å§‹/åœæ­¢ã®çŠ¶æ…‹ç®¡ç†

**UI:**
- [ ] ã‚·ãƒ³ãƒ—ãƒ«ãªéŒ²ç”»é–‹å§‹ãƒœã‚¿ãƒ³
- [ ] åœæ­¢ãƒœã‚¿ãƒ³
- [ ] ã‚«ãƒ¡ãƒ©ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
- [ ] çµŒéæ™‚é–“è¡¨ç¤º
- [ ] ä¿å­˜æ¸ˆã¿ãƒãƒ£ãƒ³ã‚¯ä¸€è¦§è¡¨ç¤ºï¼ˆé–‹ç™ºè€…å‘ã‘ï¼‰
- [ ] å€‹åˆ¥ãƒãƒ£ãƒ³ã‚¯ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³

**Test:**
- [ ] 10åˆ†ã®éŒ²ç”»ãŒæˆåŠŸã—ã€fMP4ãƒãƒ£ãƒ³ã‚¯ãŒOPFSã«æ­£å¸¸ã«ä¿å­˜ã•ã‚Œã‚‹
- [ ] å€‹åˆ¥ãƒãƒ£ãƒ³ã‚¯ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã€VLCç­‰ã®ãƒ¡ãƒ‡ã‚£ã‚¢ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã§å†ç”Ÿã§ãã‚‹
- [ ] ãƒãƒ£ãƒ³ã‚¯ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ï¼ˆtimestamp, size, hashï¼‰ãŒIndexedDBã«æ­£ã—ãä¿å­˜ã•ã‚Œã‚‹
- [ ] é€£ç¶šã™ã‚‹è¤‡æ•°ã®ãƒãƒ£ãƒ³ã‚¯ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã€é †æ¬¡å†ç”Ÿã§ãã‚‹

**Deliverable:**
- **Phase 1A å…¨ä½“ã®å®Œäº†æ¡ä»¶**
  - éŒ²ç”»â†’fMP4ãƒãƒ£ãƒ³ã‚¯ç”Ÿæˆâ†’OPFSä¿å­˜â†’å€‹åˆ¥ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã®å…¨ãƒ•ãƒ­ãƒ¼ãŒå‹•ä½œ
  - å€‹åˆ¥ãƒãƒ£ãƒ³ã‚¯ãŒå®Œå…¨ã«å†ç”Ÿå¯èƒ½ï¼ˆfMP4ã¨ã—ã¦æ­£ã—ãç”Ÿæˆã•ã‚Œã¦ã„ã‚‹ï¼‰
  - ãƒ–ãƒ©ã‚¦ã‚¶ãƒªãƒ­ãƒ¼ãƒ‰å¾Œã‚‚ãƒ‡ãƒ¼ã‚¿ãŒä¿æŒã•ã‚Œã‚‹

---

## Phase 1B: ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒ»ãƒªã‚«ãƒãƒªãƒ¼ãƒ»UIå®Œæˆ ğŸ¯

**Goal:** ãƒãƒ£ãƒ³ã‚¯çµåˆã«ã‚ˆã‚‹MP4ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã€ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãƒªã‚«ãƒãƒªãƒ¼ã€ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ¬ãƒ‡ã‚£ãªUIã‚’å®Ÿè£…

**Concept:**
- Phase 1A ã§æ¤œè¨¼æ¸ˆã¿ã®ãƒãƒ£ãƒ³ã‚¯ã‚’çµåˆã—ã¦å®Œå…¨ãªMP4ã‚’ç”Ÿæˆ
- ãƒ–ãƒ©ã‚¦ã‚¶ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãƒ»é›»æºæ–­ã‹ã‚‰ã®å¾©å…ƒæ©Ÿèƒ½
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªUIã«ä»•ä¸Šã’ã‚‹

### 1B.1 ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½ï¼ˆClient-side Concatenationï¼‰

**Goal:** ã‚µãƒ¼ãƒãƒ¼ãªã—ã§ã€OPFSå†…ã®ãƒãƒ£ãƒ³ã‚¯ã‚’çµåˆã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

**Dependencies:**
- `ReadableStream` API
- Rust WASM ã§ã®ã‚¹ãƒˆãƒªãƒ¼ãƒ å‡¦ç†

**Tasks:**
- [ ] å€‹åˆ¥ãƒãƒ£ãƒ³ã‚¯ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ã®å‰Šé™¤ï¼ˆPhase 1A ã®ãƒ†ã‚¹ãƒˆç”¨æ©Ÿèƒ½ï¼‰
- [ ] WASMå´ã§ãƒãƒ£ãƒ³ã‚¯ã‚’é †æ¬¡èª­ã¿å‡ºã™ã‚¹ãƒˆãƒªãƒ¼ãƒ ç”Ÿæˆ
- [ ] `ReadableStream` ã‚’ä½¿ã£ãŸæ®µéšçš„ãªãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å®Ÿè£…
- [ ] ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡æœ€é©åŒ–ï¼ˆå¤§å®¹é‡å‹•ç”»å¯¾å¿œï¼‰
- [ ] ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰é€²æ—è¡¨ç¤ºUI

### 1B.2 ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãƒªã‚«ãƒãƒªãƒ¼æ©Ÿèƒ½

**Goal:** ãƒ–ãƒ©ã‚¦ã‚¶ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãƒ»é›»æºæ–­ã‹ã‚‰ã®è‡ªå‹•å¾©å…ƒ

**Tasks:**
- [ ] OPFSå†…ã®æœªå®Œäº†ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¹ã‚­ãƒ£ãƒ³æ©Ÿèƒ½
- [ ] ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ç®¡ç†ï¼ˆIndexedDBï¼‰
  - é–‹å§‹æ™‚åˆ»ã€çµ‚äº†ãƒ•ãƒ©ã‚°ã€éŒ²ç”»æ™‚é–“
- [ ] èµ·å‹•æ™‚ãƒªã‚«ãƒãƒªãƒ¼ãƒã‚§ãƒƒã‚¯å‡¦ç†
- [ ] ãƒªã‚«ãƒãƒªãƒ¼ãƒ¢ãƒ¼ãƒ€ãƒ«UIå®Ÿè£…
  - ã€Œå‰å›ã®åéŒ²ï¼ˆæ—¥æ™‚ã€æ™‚é–“ï¼‰ã‚’å¾©å…ƒã—ã¾ã™ã‹ï¼Ÿã€
  - å¾©å…ƒ / ç ´æ£„ ãƒœã‚¿ãƒ³
- [ ] å¾©å…ƒå¾Œã®è‡ªå‹•ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½

### 1B.3 ãƒ‡ãƒã‚¤ã‚¹ãƒ»ç”»è³ªè¨­å®šæ©Ÿèƒ½

**Tasks:**
- [ ] ã‚«ãƒ¡ãƒ©/ãƒã‚¤ã‚¯ãƒ‡ãƒã‚¤ã‚¹åˆ—æŒ™ï¼ˆ`enumerateDevices()`ï¼‰
- [ ] ãƒ‡ãƒã‚¤ã‚¹é¸æŠUIï¼ˆãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ï¼‰
- [ ] ç”»è³ªãƒ—ãƒªã‚»ãƒƒãƒˆè¨­å®š
  - Stability Modeï¼ˆ1ç§’ã‚­ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ ã€å®‰å®šå„ªå…ˆï¼‰
  - Quality Modeï¼ˆé«˜ç”»è³ªã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºå¤§ï¼‰
- [ ] è¨­å®šã®ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ä¿å­˜

### 1B.4 UI/UX å®Œæˆç‰ˆå®Ÿè£…

**ç”»é¢æ§‹æˆ:**

1. **ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ï¼ˆå¾…æ©Ÿç”»é¢ï¼‰**
   - [ ] ä¸­å¤®ã«æ³¢å½¢ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ©ã‚¤ã‚¶ãƒ¼ï¼ˆãƒã‚¤ã‚¯å…¥åŠ›ç¢ºèªï¼‰
   - [ ] å¤§ããªã€ŒRECã€ãƒœã‚¿ãƒ³
   - [ ] æ­¯è»Šã‚¢ã‚¤ã‚³ãƒ³ï¼ˆè¨­å®šãƒ¢ãƒ¼ãƒ€ãƒ«èµ·å‹•ï¼‰
   - [ ] ã‚«ãƒ¡ãƒ©ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼

2. **åéŒ²ä¸­ç”»é¢**
   - [ ] çµŒéæ™‚é–“ã‚¿ã‚¤ãƒãƒ¼
   - [ ] ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ³¢å½¢è¡¨ç¤º
   - [ ] ã€ŒSTOPã€ãƒœã‚¿ãƒ³
   - [ ] ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºã€ŒğŸŸ¢ Saving locally (OPFS active)ã€

3. **å®Œäº†ç”»é¢ï¼ˆPost-Recordingï¼‰**
   - [ ] ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼ˆåéŒ²å†…å®¹ç¢ºèªï¼‰
   - [ ] `Download MP4` ãƒœã‚¿ãƒ³
   - [ ] `Discard`ï¼ˆå‰Šé™¤ï¼‰ãƒœã‚¿ãƒ³
   - [ ] ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰é€²æ—ãƒãƒ¼

**Tasks:**
- [ ] å„ç”»é¢ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…
- [ ] ç”»é¢é·ç§»ãƒ­ã‚¸ãƒƒã‚¯
- [ ] ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³å¯¾å¿œ

**Deliverable:**
- **Phase 1B ã®å®Œäº†æ¡ä»¶**
  - Phase 1A ã§ä½œæˆã—ãŸå€‹åˆ¥ãƒãƒ£ãƒ³ã‚¯ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ãŒå‰Šé™¤ã•ã‚Œã¦ã„ã‚‹
  - OPFSå†…ã®å…¨ãƒãƒ£ãƒ³ã‚¯ã‚’çµåˆã—ã¦ã€å®Œå…¨ãª .mp4 ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹
  - ãƒ–ãƒ©ã‚¦ã‚¶ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãƒ»é›»æºæ–­å¾Œã€ãƒªã‚«ãƒãƒªãƒ¼UIã§å¾©å…ƒã§ãã‚‹
  - ãƒ‡ãƒã‚¤ã‚¹ãƒ»ç”»è³ªè¨­å®šãŒæ­£å¸¸ã«æ©Ÿèƒ½ã™ã‚‹
  - ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ¬ãƒ‡ã‚£ãªUIãŒå®Œæˆã—ã¦ã„ã‚‹

**Overall Phase 1 (1A + 1B) Deliverable:**
- **å®Œå…¨ãªã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ³éŒ²ç”»ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆMaycast Soloï¼‰**
  - ãƒ­ã‚°ã‚¤ãƒ³ä¸è¦ã§URLï¼ˆä¾‹: `/solo`ï¼‰ã«ã‚¢ã‚¯ã‚»ã‚¹
  - éŒ²ç”»â†’fMP4åŒ–â†’OPFSä¿å­˜â†’çµåˆãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
  - ã‚¯ãƒ©ãƒƒã‚·ãƒ¥å¾©å…ƒæ©Ÿèƒ½æ­è¼‰
  - ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ¬ãƒ‡ã‚£ãªUI

---

## Phase 1.5: TypeScriptç§»è¡Œãƒ»æ§‹é€ æœ€é©åŒ– ğŸ¯

**Goal:** Phase 2ã®ã‚µãƒ¼ãƒãƒ¼å®Ÿè£…ã«å‚™ãˆã¦ã€å‹å®šç¾©ã‚’TypeScriptã«çµ±ä¸€ã—ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆã‚’æœ€é©åŒ–

**Concept:**
- commonãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’Rustã‹ã‚‰TypeScriptã«ç§»è¡Œ
- ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ»ã‚µãƒ¼ãƒãƒ¼é–“ã§å‹å®šç¾©ã‚’å…±æœ‰å¯èƒ½ã«ã™ã‚‹
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ã‚’æœ€çµ‚å½¢æ…‹ã«è¿‘ã¥ã‘ã‚‹

---

### Phase 1.5-1: å…±é€šå‹å®šç¾©ã®TypeScriptç§»è¡Œ

**Goal:** Rustã®commonãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’TypeScriptã«æ›¸ãç›´ã—ã€å‹å®‰å…¨æ€§ã‚’ç¶­æŒ

**Tasks:**
- [ ] `packages/common-types`ï¼ˆTypeScriptãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼‰ã‚’æ–°è¦ä½œæˆ
- [ ] package.jsonè¨­å®šï¼ˆname: @maycast/common-typesï¼‰
- [ ] TypeScriptè¨­å®šï¼ˆtsconfig.jsonï¼‰
  - declaration: trueï¼ˆ.d.tsãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆï¼‰
  - composite: trueï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå‚ç…§ç”¨ï¼‰
- [ ] ä»¥ä¸‹ã®å‹å®šç¾©ã‚’TypeScriptã«ç§»æ¤:
  - [ ] `ChunkId` - ãƒãƒ£ãƒ³ã‚¯ã®ä¸€æ„è­˜åˆ¥å­
  - [ ] `ChunkMetadata` - ãƒãƒ£ãƒ³ã‚¯ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
  - [ ] `RecordingMetadata` - éŒ²ç”»å…¨ä½“ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ï¼ˆã‚³ãƒ¼ãƒ‡ãƒƒã‚¯ã€è§£åƒåº¦ãªã©ï¼‰
  - [ ] `RecordingId` - éŒ²ç”»ã®ä¸€æ„è­˜åˆ¥å­ï¼ˆUUIDä½¿ç”¨ï¼‰
  - [ ] `RecordingState` - éŒ²ç”»ã®çŠ¶æ…‹ï¼ˆ'standby' | 'recording' | 'finalizing' | 'synced'ï¼‰
  - [ ] `Recording` - éŒ²ç”»å…¨ä½“ã®æƒ…å ±ï¼ˆPhase 2ã§ä½¿ç”¨ï¼‰
  - [ ] `RoomId` - Roomã®ä¸€æ„è­˜åˆ¥å­ï¼ˆPhase 4ã§ä½¿ç”¨ï¼‰
  - [ ] `Room` - Roomå…¨ä½“ã®æƒ…å ±ï¼ˆPhase 4ã§ä½¿ç”¨ï¼‰
- [ ] WebSocketãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‹å®šç¾©ã‚’è¿½åŠ ï¼ˆPhase 4ã§ä½¿ç”¨ï¼‰
  - [ ] `RoomCreated { room_id, created_at }`
  - [ ] `RoomStateChanged { room_id, state, timestamp }`
  - [ ] `RecordingCreated { room_id, recording_id, created_at }`
  - [ ] `RecordingStateChanged { room_id, recording_id, state, timestamp }`
  - [ ] `ChunkUploaded { room_id, recording_id, chunk_id, timestamp }`
  - [ ] `UploadProgress { room_id, recording_id, uploaded, total }`
  - [ ] `DirectorCommand { room_id, command: 'start' | 'stop' }`
- [ ] ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆè¨­å®šï¼ˆindex.tsï¼‰

**Test:**
- [ ] `npm run build` ã§ãƒ“ãƒ«ãƒ‰ãŒæˆåŠŸã™ã‚‹
- [ ] .d.tsãƒ•ã‚¡ã‚¤ãƒ«ãŒæ­£ã—ãç”Ÿæˆã•ã‚Œã‚‹
- [ ] web-clientã‹ã‚‰å‹ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã§ãã‚‹

**Deliverable:**
- TypeScriptãƒ™ãƒ¼ã‚¹ã®å…±é€šå‹å®šç¾©ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
- å‹å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ.d.tsï¼‰ãŒç”Ÿæˆã•ã‚Œã‚‹

---

### Phase 1.5-2: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆã®æœ€é©åŒ–

**Goal:** ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ§‹æˆã‚’è¦‹ç›´ã—ã€ä¾å­˜é–¢ä¿‚ã‚’æ•´ç†

**Project Structure (å¤‰æ›´å¾Œ):**
```text
/maycast-recorder
â”œâ”€â”€ Cargo.toml           # WASMå°‚ç”¨Workspace
â”œâ”€â”€ Taskfile.yml
â”œâ”€â”€ package.json         # Root package.jsonï¼ˆnpm workspaceï¼‰
â”œâ”€â”€ /packages
â”‚   â”œâ”€â”€ /common-types    # TypeScriptå…±é€šå‹å®šç¾©ï¼ˆæ–°è¦ï¼‰
â”‚   â”œâ”€â”€ /wasm-core       # Rust -> WASM Muxingï¼ˆå¤‰æ›´ãªã—ï¼‰
â”‚   â”œâ”€â”€ /web-client      # TypeScript Frontendï¼ˆä¾å­˜é–¢ä¿‚æ›´æ–°ï¼‰
â”‚   â””â”€â”€ /server          # å°†æ¥è¿½åŠ ï¼ˆPhase 2A-1ï¼‰
â””â”€â”€ /docs
```

**Tasks:**
- [ ] ãƒ«ãƒ¼ãƒˆpackage.jsonä½œæˆï¼ˆnpm workspacesè¨­å®šï¼‰
- [ ] workspacesãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¿½åŠ 
  ```json
  {
    "workspaces": [
      "packages/common-types",
      "packages/web-client",
      "packages/server"
    ]
  }
  ```
- [ ] web-clientã®package.jsonã‚’æ›´æ–°
  - [ ] `@maycast/common-types`ã‚’ä¾å­˜é–¢ä¿‚ã«è¿½åŠ 
  - [ ] ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ‘ã‚¹ã‚’ä¿®æ­£
- [ ] Rustã®commonãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å‰Šé™¤
  - [ ] `packages/common/`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå‰Šé™¤
  - [ ] Cargo.tomlã®workspace membersã‹ã‚‰å‰Šé™¤
- [ ] Taskfile.ymlã‚’æ›´æ–°
  - [ ] `task build:common` è¿½åŠ ï¼ˆcommon-typesã®ãƒ“ãƒ«ãƒ‰ï¼‰
  - [ ] `task build` ã‚’æ›´æ–°ï¼ˆcommon-types â†’ wasm â†’ client ã®é †ï¼‰

**Test:**
- [ ] `task build` ãŒæˆåŠŸã™ã‚‹
- [ ] web-clientã‹ã‚‰`@maycast/common-types`ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã§ãã‚‹
- [ ] TypeScriptã®å‹ãƒã‚§ãƒƒã‚¯ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹
- [ ] WASMãƒ“ãƒ«ãƒ‰ã«å½±éŸ¿ãŒãªã„

**Deliverable:**
- æœ€é©åŒ–ã•ã‚ŒãŸãƒ¢ãƒãƒ¬ãƒæ§‹æˆ
- TypeScriptã¨Rustã®æ˜ç¢ºãªè²¬ä»»åˆ†é›¢

---

### Phase 1.5-3: æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã®ç§»è¡Œã¨ãƒ†ã‚¹ãƒˆ

**Goal:** web-clientå†…ã®å‹å‚ç…§ã‚’æ–°ã—ã„common-typesã«åˆ‡ã‚Šæ›¿ãˆã€å‹•ä½œç¢ºèª

**Tasks:**
- [ ] web-clientå†…ã®å‹å®šç¾©ã‚’å‰Šé™¤
  - [ ] ãƒ­ãƒ¼ã‚«ãƒ«ã§å®šç¾©ã—ã¦ã„ãŸChunkIdç­‰ã‚’å‰Šé™¤
  - [ ] `@maycast/common-types`ã‹ã‚‰ã‚¤ãƒ³ãƒãƒ¼ãƒˆã«å¤‰æ›´
- [ ] OPFSã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å±¤ã®å‹ã‚’çµ±ä¸€
  - [ ] ChunkMetadataã®ä½¿ç”¨ç®‡æ‰€ã‚’æ›´æ–°
  - [ ] SessionStateã®ä½¿ç”¨ç®‡æ‰€ã‚’æ›´æ–°
- [ ] IndexedDBã‚¹ã‚­ãƒ¼ãƒã®å‹å®šç¾©ã‚’æ›´æ–°
- [ ] å…¨ãƒ•ã‚¡ã‚¤ãƒ«ã§TypeScriptã®å‹ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè¡Œ
  - [ ] `tsc --noEmit`ã§ã‚¨ãƒ©ãƒ¼ãŒãªã„ã“ã¨ã‚’ç¢ºèª

**Test:**
- [ ] Phase 1ã§å®Ÿè£…ã—ãŸå…¨æ©Ÿèƒ½ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹
  - [ ] éŒ²ç”»é–‹å§‹ãƒ»åœæ­¢
  - [ ] OPFSã¸ã®ãƒãƒ£ãƒ³ã‚¯ä¿å­˜
  - [ ] ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½
  - [ ] ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãƒªã‚«ãƒãƒªãƒ¼
- [ ] TypeScriptã®ãƒ“ãƒ«ãƒ‰ãŒæˆåŠŸã™ã‚‹
- [ ] ãƒ–ãƒ©ã‚¦ã‚¶ã§ã®å‹•ä½œç¢ºèª

**Deliverable:**
- common-typesã‚’ä½¿ç”¨ã—ãŸå®Œå…¨ãªPhase 1å®Ÿè£…
- Phase 2ã¸ã®æº–å‚™å®Œäº†

---

**Overall Phase 1.5 Deliverable:**
- **TypeScriptçµ±ä¸€å‹å®šç¾©ã‚·ã‚¹ãƒ†ãƒ **
  - ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ»ã‚µãƒ¼ãƒãƒ¼é–“ã§å‹ã‚’å…±æœ‰å¯èƒ½
  - Rustã®commonãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‹ã‚‰TypeScriptã¸ã®å®Œå…¨ç§»è¡Œ
  - npm workspacesã«ã‚ˆã‚‹ä¸€å…ƒç®¡ç†
- **Phase 2ã¸ã®æº–å‚™å®Œäº†**
  - ã‚µãƒ¼ãƒãƒ¼å®Ÿè£…æ™‚ã«å‹å®šç¾©ã‚’ãã®ã¾ã¾ä½¿ç”¨å¯èƒ½
  - å‹ã®äºŒé‡ç®¡ç†ã‚’å›é¿

---

## Phase 2: ã‚µãƒ¼ãƒãƒ¼å´åŸºç›¤æ§‹ç¯‰ ğŸ¯

**Goal:** Recordingç®¡ç†ã¨Chunk Upload APIã‚’å®Ÿè£…ã—ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆâ†’ã‚µãƒ¼ãƒãƒ¼ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’ç¢ºç«‹

**Concept:**
- ã‚µãƒ¼ãƒãƒ¼å´ã§Recordingï¼ˆå˜ä¸€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®éŒ²ç”»ï¼‰ã‚’ä½œæˆãƒ»ç®¡ç†ã™ã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…
- **éŒ²ç”»ä¸­ã«ãƒãƒ£ãƒ³ã‚¯ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ã‚µãƒ¼ãƒãƒ¼ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰**ï¼ˆPhase 1ã®OPFSä¿å­˜ã¨ä¸¦è¡Œï¼‰
- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼æ™‚ã‚‚ãƒ­ãƒ¼ã‚«ãƒ«éŒ²ç”»ã‚’ç¶™ç¶šã™ã‚‹å …ç‰¢æ€§ã‚’ç¶­æŒ
- ã‚µãƒ¼ãƒãƒ¼å´ã®å„æ©Ÿèƒ½ã‚’ç‹¬ç«‹ã—ã¦ãƒ†ã‚¹ãƒˆå¯èƒ½ãªçŠ¶æ…‹ã§å®Ÿè£…
- å„ã‚µãƒ–ãƒ•ã‚§ãƒ¼ã‚ºã§ç‹¬ç«‹ã—ãŸæˆæœç‰©ã‚’ç”Ÿæˆã—ã€æ¤œè¨¼å¯èƒ½ã«ã™ã‚‹
- **HTTP APIã®ã¿ã§å®Ÿè£…**ï¼ˆWebSocketã¯Phase 4ã®Roomæ©Ÿèƒ½ã§å°å…¥ï¼‰
- **Phase 4ã®Roomæ©Ÿèƒ½ï¼ˆè¤‡æ•°Recordingã‚’æŸã­ã‚‹ï¼‰ã®åŸºç›¤ã‚’æ§‹ç¯‰**

**ç”¨èªå®šç¾©:**
- **Recording**: å˜ä¸€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®éŒ²ç”»ãƒ‡ãƒ¼ã‚¿ï¼ˆPhase 2ã§å®Ÿè£…ï¼‰
- **Room**: è¤‡æ•°Recordingã‚’æŸã­ã‚‹åéŒ²ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼ˆPhase 4ã§å®Ÿè£…ï¼‰
  - ä¾‹: Roomå†…ã«Guest A, B, Cã®3ã¤ã®RecordingãŒå«ã¾ã‚Œã‚‹

**å…¨ä½“ãƒ•ãƒ­ãƒ¼ï¼ˆPhase 2: Remote Mode - å˜ä¸€Recordingï¼‰:**
```text
[Client: /remote]                           [Server]
   |                                           |
ã€åˆæœŸåŒ–ã€‘
   |-- GET /health ------------------------->  | ã‚µãƒ¼ãƒãƒ¼æ¥ç¶šç¢ºèª
   |<-- 200 OK ------------------------------|
   |                                           |
ã€éŒ²ç”»é–‹å§‹å‰ã€‘
   | ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€ŒRECã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ä¸‹              |
   |                                           |
   |-- 1. POST /api/recordings ------------->  | Recordingä½œæˆ
   |<-- recording_id, state: "standby" -------|
   |                                           |
   |-- 2. PATCH /api/recordings/:id/metadata -> | RecordingMetadataä¿å­˜
   |<-- OK -----------------------------------|
   |                                           |
   |-- 3. PATCH /api/recordings/:id/state --->  | state: "recording"
   |<-- OK -----------------------------------|
   |                                           |
ã€éŒ²ç”»ä¸­ - WebCodecsç¨¼åƒã€‘
   |                                           |
   | WebCodecs: ãƒãƒ£ãƒ³ã‚¯ç”Ÿæˆ                    |
   |   â”œâ”€> OPFSä¿å­˜ï¼ˆãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼‰             |
   |   â””â”€> ChunkUploaderçµŒç”±ã§ã‚µãƒ¼ãƒãƒ¼é€ä¿¡ --->  |
   |                                           |
   |-- 4. POST /recordings/:id/chunks/001 ---> | ãƒãƒ£ãƒ³ã‚¯ä¿å­˜
   |<-- 201 Created --------------------------|  â””â”€> ./storage/{recording_id}/chunk-001.fmp4
   |                                           |
   | WebCodecs: æ¬¡ã®ãƒãƒ£ãƒ³ã‚¯ç”Ÿæˆ                |
   |   â”œâ”€> OPFSä¿å­˜                           |
   |   â””â”€> ã‚µãƒ¼ãƒãƒ¼ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆä¸¦è¡Œ3ä¸¦åˆ—ï¼‰--->  |
   |                                           |
   |-- 5. POST /recordings/:id/chunks/002 ---> | ãƒãƒ£ãƒ³ã‚¯ä¿å­˜
   |<-- 201 Created --------------------------|
   |                                           |
   |   ... (éŒ²ç”»ä¸­ã€éšæ™‚ãƒãƒ£ãƒ³ã‚¯ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰)      |
   |                                           |
ã€éŒ²ç”»åœæ­¢ã€‘
   | ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€ŒSTOPã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ä¸‹            |
   | WebCodecs: åœæ­¢                          |
   | æœªé€ä¿¡ãƒãƒ£ãƒ³ã‚¯ã®å®Œäº†ã‚’å¾…æ©Ÿ...              |
   | UI: "Finalizing upload..." è¡¨ç¤º          |
   |                                           |
   |-- N. PATCH /api/recordings/:id/state ---> | state: "synced"
   |<-- OK -----------------------------------|
   |                                           |
   | âœ“ éŒ²ç”»å®Œäº† & ã‚µãƒ¼ãƒãƒ¼åŒæœŸå®Œäº†             |
   | UI: "âœ“ Synced to server" è¡¨ç¤º            |
```

**Phase 4ã§ã®Roomæ‹¡å¼µã‚¤ãƒ¡ãƒ¼ã‚¸:**
```text
[Director: /director]                       [Server]
   |-- POST /api/rooms ----------------------> | Roomä½œæˆ
   |<-- room_id, guest_url ------------------|  â””â”€> room_id: "room-abc123"
   |                                           |     guest_url: "/guest/room-abc123"
   | Director: Guest URLã‚’é…å¸ƒ                |

[Guest A: /guest/room-abc123]
   |-- POST /api/recordings ----------------->  | Recordingä½œæˆï¼ˆroom_idç´ä»˜ã‘ï¼‰
   |<-- recording_id (recording_a) -----------|
   |-- éŒ²ç”»ãƒ»ãƒãƒ£ãƒ³ã‚¯ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ ------------->  | ./storage/room-abc123/recording_a/chunk-*.fmp4

[Guest B: /guest/room-abc123]
   |-- POST /api/recordings ----------------->  | Recordingä½œæˆï¼ˆroom_idç´ä»˜ã‘ï¼‰
   |<-- recording_id (recording_b) -----------|
   |-- éŒ²ç”»ãƒ»ãƒãƒ£ãƒ³ã‚¯ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ ------------->  | ./storage/room-abc123/recording_b/chunk-*.fmp4

â†’ åŒä¸€Roomå†…ã«è¤‡æ•°RecordingãŒé›†ç´„ã•ã‚Œã‚‹
```

**Note:** Standalone Mode (`/solo`) ã§ã¯ä¸Šè¨˜ã®ã‚µãƒ¼ãƒãƒ¼é€šä¿¡ã¯ä¸€åˆ‡è¡Œã‚ãšã€OPFSä¿å­˜ã®ã¿ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

---

### Phase 2A-1: ã‚µãƒ¼ãƒãƒ¼ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

**Goal:** TypeScript + Expressãƒ™ãƒ¼ã‚¹ã®ã‚µãƒ¼ãƒãƒ¼åŸºç›¤ã‚’æ§‹ç¯‰ã—ã€åŸºæœ¬çš„ãªå‹•ä½œç¢ºèª

**Project Structure:**
```text
/maycast-recorder
â”œâ”€â”€ /packages
â”‚   â”œâ”€â”€ /common          # æ—¢å­˜ï¼ˆPhase 1ã§ä½œæˆæ¸ˆã¿ï¼‰
â”‚   â”œâ”€â”€ /wasm-core       # æ—¢å­˜ï¼ˆPhase 1ã§ä½œæˆæ¸ˆã¿ï¼‰
â”‚   â”œâ”€â”€ /web-client      # æ—¢å­˜ï¼ˆPhase 1ã§ä½œæˆæ¸ˆã¿ï¼‰
â”‚   â””â”€â”€ /server          # æ–°è¦ä½œæˆï¼ˆTypeScript + Express ã‚µãƒ¼ãƒãƒ¼ï¼‰
â””â”€â”€ Taskfile.yml
```

**Tasks:**
- [ ] `server` ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ä½œæˆï¼ˆpackage.jsonè¨­å®šï¼‰
- [ ] TypeScript + Express ã®ä¾å­˜é–¢ä¿‚è¿½åŠ 
  - express, @types/express
  - typescript, ts-node, nodemon
  - dotenv, cors, morgan (ãƒ­ã‚®ãƒ³ã‚°)
- [ ] TypeScriptè¨­å®šï¼ˆtsconfig.jsonï¼‰
- [ ] åŸºæœ¬çš„ãªserver.tså®Ÿè£…ï¼ˆã‚µãƒ¼ãƒãƒ¼èµ·å‹•ãƒ­ã‚¸ãƒƒã‚¯ï¼‰
- [ ] `/health` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…
- [ ] ç’°å¢ƒå¤‰æ•°è¨­å®šï¼ˆ.env: PORT, LOG_LEVELï¼‰
- [ ] Taskfile.yml ã«ã‚µãƒ¼ãƒãƒ¼é–¢é€£ã‚¿ã‚¹ã‚¯è¿½åŠ 
  - `task dev:server` - ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ï¼ˆnodemonï¼‰
  - `task build:server` - TypeScriptã‚³ãƒ³ãƒ‘ã‚¤ãƒ«
  - `task test:server` - ã‚µãƒ¼ãƒãƒ¼ãƒ†ã‚¹ãƒˆ

**Test:**
- [ ] `task build:server` ãŒæˆåŠŸã™ã‚‹
- [ ] `task dev:server` ã§ã‚µãƒ¼ãƒãƒ¼ãŒèµ·å‹•ã™ã‚‹ï¼ˆä¾‹: http://localhost:3000ï¼‰
- [ ] `curl http://localhost:3000/health` ã§ `{"status": "ok"}` ãŒè¿”ã‚‹
- [ ] ãƒ­ã‚°ãŒæ­£å¸¸ã«å‡ºåŠ›ã•ã‚Œã‚‹

**Deliverable:**
- å‹•ä½œã™ã‚‹Expressã‚µãƒ¼ãƒãƒ¼ã®åŸºç›¤
- `/health` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯å¯èƒ½

---

### Phase 2A-2: Recordingç®¡ç†APIå®Ÿè£…

**Goal:** Recordingï¼ˆå˜ä¸€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®éŒ²ç”»ï¼‰ã®ä½œæˆãƒ»å–å¾—ãƒ»çŠ¶æ…‹ç®¡ç†APIã‚’å®Ÿè£…

**Concept:**
- ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒéŒ²ç”»ã‚’é–‹å§‹ã™ã‚‹å‰ã«ã€ã‚µãƒ¼ãƒãƒ¼ã«æ–°ã—ã„Recordingã‚’ä½œæˆ
- ã‚µãƒ¼ãƒãƒ¼ãŒRecording IDã‚’ç™ºè¡Œã—ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«è¿”å´
- ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ãã®Recording IDã‚’ä½¿ã£ã¦ãƒãƒ£ãƒ³ã‚¯ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- Recordingã®çŠ¶æ…‹ï¼ˆStandby, Recording, Finalizing, Syncedï¼‰ã‚’ç®¡ç†
- **Phase 4ã§Roomæ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹éš›ã®åŸºç›¤**

**Dependencies:**
- `uuid` (Recording IDç”Ÿæˆ)

**Storage Structure:**
```text
Serverå´ã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ ï¼ˆPhase 2ï¼‰:
/storage
â”œâ”€â”€ /{recording_id_1}/
â”‚   â”œâ”€â”€ chunk-001.fmp4
â”‚   â”œâ”€â”€ chunk-002.fmp4
â”‚   â””â”€â”€ ...
â””â”€â”€ /{recording_id_2}/
    â”œâ”€â”€ chunk-001.fmp4
    â””â”€â”€ ...

Recordingãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ï¼ˆPhase 2ã§ã¯ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªMapï¼‰:
recordings: Map<recording_id, Recording>
```

**Phase 4ã§ã®Roomæ‹¡å¼µæ™‚ã®Storageæ§‹é€ :**
```text
/storage
â””â”€â”€ /{room_id}/
    â”œâ”€â”€ /{recording_id_1}/  # Guest A
    â”‚   â”œâ”€â”€ chunk-001.fmp4
    â”‚   â””â”€â”€ ...
    â”œâ”€â”€ /{recording_id_2}/  # Guest B
    â”‚   â””â”€â”€ ...
    â””â”€â”€ /{recording_id_3}/  # Guest C
        â””â”€â”€ ...
```

**Tasks:**
- [ ] Recordingãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«å®šç¾©ï¼ˆTypeScriptï¼‰
  ```typescript
  interface Recording {
    id: string;           // UUID
    state: RecordingState;  // 'standby' | 'recording' | 'finalizing' | 'synced'
    createdAt: Date;
    startedAt?: Date;
    finishedAt?: Date;
    metadata?: RecordingMetadata;
    chunkCount: number;
    roomId?: string;      // Phase 4ã§ä½¿ç”¨ï¼ˆPhase 2ã§ã¯nullï¼‰
  }
  ```
- [ ] Recordingã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å®Ÿè£…ï¼ˆã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªMapï¼‰
  - `recordings: Map<string, Recording>`
  - Phase 7ã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ç§»è¡Œäºˆå®š
- [ ] `POST /api/recordings` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…
  - æ–°ã—ã„Recordingã‚’ä½œæˆ
  - UUIDã§Recording IDç”Ÿæˆ
  - åˆæœŸçŠ¶æ…‹ã¯ `standby`
  - ãƒ¬ã‚¹ãƒãƒ³ã‚¹: `{ recording_id, created_at, state }`
- [ ] `GET /api/recordings/:recording_id` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…
  - Recordingæƒ…å ±ã‚’å–å¾—
  - å­˜åœ¨ã—ãªã„å ´åˆã¯ `404 Not Found`
- [ ] `PATCH /api/recordings/:recording_id/state` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…
  - RecordingçŠ¶æ…‹ã‚’æ›´æ–°
  - ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£: `{ state: RecordingState }`
  - çŠ¶æ…‹é·ç§»ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆStandby â†’ Recording â†’ Finalizing â†’ Syncedï¼‰
- [ ] `PATCH /api/recordings/:recording_id/metadata` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…
  - éŒ²ç”»ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
  - ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£: `RecordingMetadata`
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
  - ä¸æ­£ãªçŠ¶æ…‹é·ç§»: `400 Bad Request`
  - Recordingæœªå­˜åœ¨: `404 Not Found`

**Test:**
- [ ] curlã§Recordingä½œæˆ
  ```bash
  curl -X POST http://localhost:3000/api/recordings \
    -H "Content-Type: application/json"
  # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹: {"recording_id": "550e8400-e29b-41d4-a716-446655440000", ...}
  ```
- [ ] Recordingæƒ…å ±å–å¾—
  ```bash
  curl http://localhost:3000/api/recordings/550e8400-e29b-41d4-a716-446655440000
  ```
- [ ] çŠ¶æ…‹æ›´æ–°
  ```bash
  curl -X PATCH http://localhost:3000/api/recordings/550e8400-e29b-41d4-a716-446655440000/state \
    -H "Content-Type: application/json" \
    -d '{"state": "recording"}'
  ```
- [ ] ä¸æ­£ãªçŠ¶æ…‹é·ç§»ã§ã‚¨ãƒ©ãƒ¼ãŒè¿”ã‚‹ï¼ˆstandby â†’ synced ãªã©ï¼‰
- [ ] å­˜åœ¨ã—ãªã„Recording IDã§404ãŒè¿”ã‚‹

**Deliverable:**
- Recordingç®¡ç†APIï¼ˆä½œæˆã€å–å¾—ã€çŠ¶æ…‹æ›´æ–°ï¼‰
- Recordingãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†
- Phase 4ã®Roomæ©Ÿèƒ½å®Ÿè£…ã«å‘ã‘ãŸåŸºç›¤

---

### Phase 2A-3: ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸åŸºç›¤

**Goal:** ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã¸ã®ãƒãƒ£ãƒ³ã‚¯ä¿å­˜ãƒ»èª­ã¿å‡ºã—æ©Ÿèƒ½ã‚’å˜ä½“ã§å®Ÿè£…

**Dependencies:**
- `fs/promises` (éåŒæœŸãƒ•ã‚¡ã‚¤ãƒ«IO)
- `blake3` (ãƒãƒƒã‚·ãƒ¥æ¤œè¨¼ç”¨ã€npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼‰

**Tasks:**
- [ ] `storage` ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ä½œæˆï¼ˆsrc/storage/ï¼‰
- [ ] `StorageBackend` ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©
  - `putChunk(sessionId: string, chunkId: string, data: Buffer): Promise<void>`
  - `getChunk(sessionId: string, chunkId: string): Promise<Buffer>`
  - `listChunks(sessionId: string): Promise<string[]>`
  - `deleteChunk(sessionId: string, chunkId: string): Promise<void>`
- [ ] `LocalFileSystemStorage` ã‚¯ãƒ©ã‚¹å®Ÿè£…
  - ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹: `./storage/{session_id}/{chunk_id}.fmp4`
  - ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªè‡ªå‹•ä½œæˆï¼ˆfs.mkdir with recursiveï¼‰
- [ ] ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆä½œæˆï¼ˆJest or Vitestï¼‰
  - ãƒãƒ£ãƒ³ã‚¯æ›¸ãè¾¼ã¿â†’èª­ã¿å‡ºã—â†’å‰Šé™¤ã®ãƒ†ã‚¹ãƒˆ
  - å­˜åœ¨ã—ãªã„ãƒãƒ£ãƒ³ã‚¯ã®èª­ã¿å‡ºã—ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

**Test:**
- [ ] `task test:server` ã§å…¨ãƒ†ã‚¹ãƒˆãŒæˆåŠŸã™ã‚‹
- [ ] ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§ãƒãƒ£ãƒ³ã‚¯ã‚’æ›¸ãè¾¼ã¿ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã«ä¿å­˜ã•ã‚Œã‚‹
- [ ] ä¿å­˜ã•ã‚ŒãŸãƒãƒ£ãƒ³ã‚¯ã‚’èª­ã¿å‡ºã—ã¦ã€å…ƒã®ãƒ‡ãƒ¼ã‚¿ã¨ä¸€è‡´ã™ã‚‹
- [ ] `listChunks()` ã§ä¿å­˜ã•ã‚ŒãŸãƒãƒ£ãƒ³ã‚¯ä¸€è¦§ã‚’å–å¾—ã§ãã‚‹

**Deliverable:**
- ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®å®Œå…¨ãªå®Ÿè£…
- å˜ä½“ãƒ†ã‚¹ãƒˆã§ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸æ©Ÿèƒ½ãŒæ¤œè¨¼æ¸ˆã¿

---

### Phase 2A-4: Chunk Upload API åŸºæœ¬å®Ÿè£…

**Goal:** ãƒãƒ£ãƒ³ã‚¯ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ç”¨ã®HTTP APIã‚’å®Ÿè£…ï¼ˆRecordingæ¤œè¨¼ä»˜ãï¼‰

**Tasks:**
- [ ] `POST /api/recordings/:recording_id/chunks/:chunk_id` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…
- [ ] Recordingå­˜åœ¨ç¢ºèª
  - RecordingãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ `404 Not Found`
  - RecordingçŠ¶æ…‹ãŒ `recording` ã¾ãŸã¯ `finalizing` ã§ãªã„å ´åˆã¯ `400 Bad Request`
- [ ] ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã‹ã‚‰ãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿å–å¾—ï¼ˆexpress.raw() middlewareä½¿ç”¨ï¼‰
- [ ] `StorageBackend.putChunk()` ã‚’å‘¼ã³å‡ºã—ã¦ä¿å­˜
- [ ] Recordingã®ãƒãƒ£ãƒ³ã‚¯ã‚«ã‚¦ãƒ³ãƒˆã‚’æ›´æ–°
- [ ] ãƒ¬ã‚¹ãƒãƒ³ã‚¹è¿”å´ï¼ˆ201 Createdï¼‰
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ï¼ˆ400 Bad Request, 404 Not Found, 500 Internal Server Errorï¼‰
- [ ] `GET /api/recordings/:recording_id/chunks/:chunk_id` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…ï¼ˆæ¤œè¨¼ç”¨ï¼‰
- [ ] ç°¡æ˜“çš„ãªãƒ­ã‚®ãƒ³ã‚°è¿½åŠ ï¼ˆmorganï¼‰

**Test:**
- [ ] äº‹å‰ã«Recordingä½œæˆ
  ```bash
  RECORDING_ID=$(curl -X POST http://localhost:3000/api/recordings | jq -r '.recording_id')
  curl -X PATCH http://localhost:3000/api/recordings/$RECORDING_ID/state \
    -H "Content-Type: application/json" \
    -d '{"state": "recording"}'
  ```
- [ ] curlã§ãƒ†ã‚¹ãƒˆãƒãƒ£ãƒ³ã‚¯ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
  ```bash
  curl -X POST http://localhost:3000/api/recordings/$RECORDING_ID/chunks/chunk-001 \
    --data-binary @test-chunk.fmp4 \
    -H "Content-Type: application/octet-stream"
  ```
- [ ] ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒãƒ£ãƒ³ã‚¯ãŒ `./storage/{recording_id}/chunk-001.fmp4` ã«ä¿å­˜ã•ã‚Œã‚‹
- [ ] `GET /api/recordings/{recording_id}/chunks/chunk-001` ã§ä¿å­˜ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã§ãã‚‹
- [ ] ä¿å­˜ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã¨ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒä¸€è‡´ã™ã‚‹
- [ ] Recordingã®chunk_countãŒå¢—åŠ ã™ã‚‹
- [ ] å­˜åœ¨ã—ãªã„Recordingã¸ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã§404ãŒè¿”ã‚‹
- [ ] standbyçŠ¶æ…‹ã®Recordingã¸ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã§400ãŒè¿”ã‚‹

**Deliverable:**
- Recordingæ¤œè¨¼ä»˜ãChunk Upload API
- curlã‚„Postmanã§æ‰‹å‹•ãƒ†ã‚¹ãƒˆå¯èƒ½

---

### Phase 2A-5: Remote Modeå®Ÿè£…ï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ï¼‰

**Goal:** Phase 1ã®Standalone Modeã¨ã¯åˆ¥ã«ã€ã‚µãƒ¼ãƒãƒ¼ã¨é€£æºã™ã‚‹ã€ŒRemote Modeã€ã‚’æ–°è¦å®Ÿè£…ã€‚UIå®Œå…¨å…±é€šåŒ–ã«ã‚ˆã‚Šä¿å®ˆæ€§å‘ä¸Šã€‚

**Overall Concept:**
- **Standalone Mode (Phase 1)**: `/solo` - ã‚µãƒ¼ãƒãƒ¼ãªã—ã€OPFSä¿å­˜ã®ã¿ã€å®Œå…¨ã‚ªãƒ•ãƒ©ã‚¤ãƒ³
- **Remote Mode (Phase 2)**: `/remote` - ã‚µãƒ¼ãƒãƒ¼é€£æºã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- **UIå…±é€šåŒ–**: MainLayout, Sidebar, Recorderã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä¸¡ãƒ¢ãƒ¼ãƒ‰ã§å…±æœ‰
- **ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸æˆ¦ç•¥ãƒ‘ã‚¿ãƒ¼ãƒ³**: ä¿å­˜ãƒ­ã‚¸ãƒƒã‚¯ã®ã¿ã‚’åˆ‡ã‚Šæ›¿ãˆå¯èƒ½ãªè¨­è¨ˆ

Remote Modeã®ãƒ•ãƒ­ãƒ¼:
1. **éŒ²ç”»é–‹å§‹å‰**: ã‚µãƒ¼ãƒãƒ¼ã«Recordingä½œæˆ â†’ recording_idå–å¾—
2. **éŒ²ç”»é–‹å§‹**: recording_idã‚’ä½¿ã£ã¦éŒ²ç”»é–‹å§‹ã€çŠ¶æ…‹ã‚’`recording`ã«æ›´æ–°
3. **éŒ²ç”»ä¸­**: ãƒãƒ£ãƒ³ã‚¯ç”Ÿæˆæ™‚ã«ä»¥ä¸‹ã‚’ä¸¦è¡Œå®Ÿè¡Œ
   - OPFSä¿å­˜ï¼ˆãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨ã—ã¦ï¼‰
   - ã‚µãƒ¼ãƒãƒ¼ã¸è‡ªå‹•ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆãƒ¡ã‚¤ãƒ³ï¼‰
4. **éŒ²ç”»åœæ­¢**: å…¨ãƒãƒ£ãƒ³ã‚¯ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Œäº†ã‚’ç¢ºèªã€çŠ¶æ…‹ã‚’`synced`ã«æ›´æ–°

**Project Structure:**
```text
/packages/web-client/src
â”œâ”€â”€ /storage-strategies     # ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸æˆ¦ç•¥ï¼ˆæ–°è¦ï¼‰
â”‚   â”œâ”€â”€ IStorageStrategy.ts           # æˆ¦ç•¥ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
â”‚   â”œâ”€â”€ StandaloneStorageStrategy.ts  # Standalone Modeç”¨
â”‚   â””â”€â”€ RemoteStorageStrategy.ts      # Remote Modeç”¨
â”œâ”€â”€ /modes
â”‚   â””â”€â”€ /remote             # Remote Modeå°‚ç”¨ãƒ­ã‚¸ãƒƒã‚¯
â”‚       â”œâ”€â”€ RecordingManager.ts    # Recordingç®¡ç†
â”‚       â”œâ”€â”€ ChunkUploader.ts       # ãƒãƒ£ãƒ³ã‚¯ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
â”‚       â””â”€â”€ serverConfig.ts        # ã‚µãƒ¼ãƒãƒ¼è¨­å®š
â”œâ”€â”€ /components             # UIï¼ˆä¸¡ãƒ¢ãƒ¼ãƒ‰ã§å…±æœ‰ï¼‰
â”‚   â”œâ”€â”€ Recorder.tsx        # éŒ²ç”»ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆæˆ¦ç•¥ã‚’æ³¨å…¥ï¼‰
â”‚   â”œâ”€â”€ /organisms
â”‚   â”‚   â”œâ”€â”€ MainHeader.tsx
â”‚   â”‚   â”œâ”€â”€ VideoPreview.tsx
â”‚   â”‚   â”œâ”€â”€ StatsPanel.tsx
â”‚   â”‚   â””â”€â”€ ControlPanel.tsx
â”‚   â””â”€â”€ /templates
â”‚       â””â”€â”€ MainLayout.tsx
â””â”€â”€ App.tsx
    â”œâ”€â”€ Route: /solo â†’ Recorder + StandaloneStorageStrategy
    â””â”€â”€ Route: /remote â†’ Recorder + RemoteStorageStrategy
```

**Phase 4ã§ã®Guest Modeè¿½åŠ ã‚¤ãƒ¡ãƒ¼ã‚¸:**
```text
â””â”€â”€ /storage-strategies
    â”œâ”€â”€ StandaloneStorageStrategy.ts
    â”œâ”€â”€ RemoteStorageStrategy.ts
    â””â”€â”€ GuestStorageStrategy.ts      # Phase 4ã§è¿½åŠ 
â””â”€â”€ /modes
    â”œâ”€â”€ /remote
    â”œâ”€â”€ /guest                        # Phase 4ã§è¿½åŠ 
    â”‚   â””â”€â”€ SessionManager.ts
    â””â”€â”€ /director                     # Phase 4ã§è¿½åŠ 
        â”œâ”€â”€ RoomManager.ts
        â””â”€â”€ MultiRecordingCoordinator.ts
```

---

#### Phase 2A-5-1: ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸æˆ¦ç•¥ã®æŠ½å‡ºã¨å…±é€šåŒ–æº–å‚™

**Goal:** Recorderã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰ä¿å­˜ãƒ­ã‚¸ãƒƒã‚¯ã‚’æŠ½å‡ºã—ã€æˆ¦ç•¥ãƒ‘ã‚¿ãƒ¼ãƒ³ã§åˆ‡ã‚Šæ›¿ãˆå¯èƒ½ã«ã™ã‚‹

**Tasks:**
- [ ] `IStorageStrategy` ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©
  ```typescript
  interface IStorageStrategy {
    onChunkGenerated(recordingId: RecordingId, chunkId: number, data: Uint8Array): Promise<void>;
    onRecordingStart(recordingId: RecordingId): Promise<void>;
    onRecordingStop(recordingId: RecordingId): Promise<void>;
    getUploadProgress?(): { uploaded: number; total: number };
  }
  ```
- [ ] æ—¢å­˜ã®OPFSä¿å­˜ãƒ­ã‚¸ãƒƒã‚¯ã‚’ `StandaloneStorageStrategy.ts` ã«æŠ½å‡º
  - useRecorder, useEncoders ã‹ã‚‰OPFSä¿å­˜å‡¦ç†ã‚’åˆ†é›¢
  - ChunkStorageã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æ´»ç”¨
- [ ] `Recorder.tsx` ã«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸æˆ¦ç•¥ã‚’æ³¨å…¥ã§ãã‚‹ã‚ˆã†ä¿®æ­£
  ```typescript
  interface RecorderProps {
    settings: RecorderSettings;
    storageStrategy: IStorageStrategy;
    // ... ãã®ä»–
  }
  ```
- [ ] App.tsx ã§ `/solo` ã« `StandaloneStorageStrategy` ã‚’æ³¨å…¥
- [ ] æ—¢å­˜ã® `/solo` ãŒå¤‰æ›´å‰ã¨åŒã˜ã‚ˆã†ã«å‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª

**Test:**
- [ ] `/solo` ã«ã‚¢ã‚¯ã‚»ã‚¹ â†’ ä»¥å‰ã¨åŒã˜UIãƒ»å‹•ä½œ
- [ ] éŒ²ç”»é–‹å§‹â†’åœæ­¢â†’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ ãŒæ­£å¸¸å‹•ä½œ
- [ ] OPFSã«ãƒãƒ£ãƒ³ã‚¯ãŒä¿å­˜ã•ã‚Œã‚‹
- [ ] ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã«ã‚ˆã‚‹æ©Ÿèƒ½é€€è¡Œãªã—

**Deliverable:**
- ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸æˆ¦ç•¥ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å°å…¥
- Standalone Modeã®å‹•ä½œç¶­æŒ
- ã‚³ãƒ¼ãƒ‰ã®ä¿å®ˆæ€§ãƒ»æ‹¡å¼µæ€§å‘ä¸Š

---

#### Phase 2A-5-2: Remote ModeåŸºç›¤ï¼ˆã‚µãƒ¼ãƒãƒ¼é€šä¿¡å±¤ï¼‰

**Goal:** Remoteã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼ã®ãŸã‚ã®Recordingç®¡ç†ã¨ã‚µãƒ¼ãƒãƒ¼é€šä¿¡ã‚’å®Ÿè£…

**Tasks:**
- [ ] `RecordingManager.ts` å®Ÿè£…
  - `createRecording()` - `POST /api/recordings`
  - `updateRecordingState(recordingId, state)` - `PATCH /api/recordings/:id/state`
  - `updateRecordingMetadata(recordingId, metadata)` - `PATCH /api/recordings/:id/metadata`
  - `checkServerConnection()` - `GET /health`
  - Recording IDã‚’ãƒ¡ãƒ¢ãƒªã«ä¿æŒ
- [ ] `serverConfig.ts` å®Ÿè£…
  - `getServerUrl()` - localStorageã‹ã‚‰å–å¾—
  - `setServerUrl(url)` - localStorageã«ä¿å­˜
  - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: `http://localhost:3000`
- [ ] ã‚µãƒ¼ãƒãƒ¼URLè¨­å®šUIã‚’Settingsç”»é¢ã«çµ±åˆ
  - Settingsç”»é¢ã«ã€ŒServer URLã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¿½åŠ 
  - æ¥ç¶šãƒ†ã‚¹ãƒˆãƒœã‚¿ãƒ³ï¼ˆ`GET /health`ï¼‰
  - æ¥ç¶šçŠ¶æ…‹ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ï¼ˆğŸŸ¢ Connected / ğŸ”´ Disconnectedï¼‰
- [ ] ã‚µãƒ¼ãƒãƒ¼å´CORSè¨­å®šã®ç¢ºèªãƒ»è¿½åŠ 
  - `packages/server/src/index.ts` ã§CORSæœ‰åŠ¹åŒ–
  - é–‹ç™ºç’°å¢ƒ: `http://localhost:5173` ã‚’è¨±å¯

**Test:**
- [ ] Settingsç”»é¢ã§ã‚µãƒ¼ãƒãƒ¼URLã‚’è¨­å®šã§ãã‚‹
- [ ] è¨­å®šãŒlocalStorageã«ä¿å­˜ã•ã‚Œã‚‹
- [ ] æ¥ç¶šãƒ†ã‚¹ãƒˆãƒœã‚¿ãƒ³ã§æ¥ç¶šç¢ºèªãŒã§ãã‚‹
- [ ] ã‚µãƒ¼ãƒãƒ¼èµ·å‹•æ™‚: ğŸŸ¢ Connected è¡¨ç¤º
- [ ] ã‚µãƒ¼ãƒãƒ¼åœæ­¢æ™‚: ğŸ”´ Disconnected è¡¨ç¤º
- [ ] RecordingManager.createRecording() ã§RecordingãŒä½œæˆã•ã‚Œã‚‹
- [ ] ã‚µãƒ¼ãƒãƒ¼å´ã§Recordingãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèª
  ```bash
  curl http://localhost:3000/api/recordings/{recording_id}
  ```

**Deliverable:**
- Recordingç®¡ç†APIé€šä¿¡ã®å®Ÿè£…
- ã‚µãƒ¼ãƒãƒ¼è¨­å®šUI
- ã‚µãƒ¼ãƒãƒ¼æ¥ç¶šç¢ºèªæ©Ÿèƒ½

---

#### Phase 2A-5-3: ãƒãƒ£ãƒ³ã‚¯ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½

**Goal:** ãƒãƒ£ãƒ³ã‚¯ã‚’ã‚µãƒ¼ãƒãƒ¼ã¸ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…ï¼ˆã‚­ãƒ¥ãƒ¼ç®¡ç†ãƒ»ãƒªãƒˆãƒ©ã‚¤æ©Ÿèƒ½ä»˜ãï¼‰

**Tasks:**
- [ ] `ChunkUploader.ts` å®Ÿè£…
  - `uploadChunk(recordingId, chunkId, data: Uint8Array)` - `POST /api/recordings/:id/chunks/:chunkId`
  - ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ¥ãƒ¼ç®¡ç†
    - ãƒãƒ£ãƒ³ã‚¯ç”Ÿæˆé †ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
    - ä¸¦è¡Œã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ•°ã®åˆ¶é™ï¼ˆæœ€å¤§3ä¸¦åˆ—ï¼‰
  - å¤±æ•—æ™‚ã®è‡ªå‹•ãƒªãƒˆãƒ©ã‚¤ï¼ˆæœ€å¤§3å›ï¼‰
  - ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰çŠ¶æ…‹ç®¡ç†
    - ãƒãƒ£ãƒ³ã‚¯ã”ã¨ã®çŠ¶æ…‹: `pending` / `uploading` / `uploaded` / `failed`
- [ ] IndexedDBã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰çŠ¶æ…‹ã‚’è¨˜éŒ²
  - `upload_states` ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ
  - ã‚¹ã‚­ãƒ¼ãƒ: `{recordingId, chunkId, state, retryCount, lastAttempt}`
- [ ] ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰çŠ¶æ…‹ã®å‹å®šç¾©
  ```typescript
  type UploadState = 'pending' | 'uploading' | 'uploaded' | 'failed';
  interface ChunkUploadStatus {
    recordingId: RecordingId;
    chunkId: number;
    state: UploadState;
    retryCount: number;
    lastAttempt: number;
  }
  ```

**Test:**
- [ ] ãƒãƒ£ãƒ³ã‚¯ãŒã‚­ãƒ¥ãƒ¼ã«è¿½åŠ ã•ã‚Œã‚‹
- [ ] ä¸¦è¡Œã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãŒæœ€å¤§3ä¸¦åˆ—ã«åˆ¶é™ã•ã‚Œã‚‹
- [ ] ãƒ–ãƒ©ã‚¦ã‚¶ã®Network Tabã§åŒæ™‚æ¥ç¶šæ•°ã‚’ç¢ºèª
- [ ] ã‚µãƒ¼ãƒãƒ¼ãƒ­ã‚°ã§ä¸¦è¡Œãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ç¢ºèª
- [ ] ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¤±æ•—æ™‚ã€è‡ªå‹•ãƒªãƒˆãƒ©ã‚¤ã•ã‚Œã‚‹ï¼ˆæœ€å¤§3å›ï¼‰
- [ ] IndexedDBã«çŠ¶æ…‹ãŒè¨˜éŒ²ã•ã‚Œã‚‹
- [ ] 3å›å¤±æ•—ã—ãŸãƒãƒ£ãƒ³ã‚¯ã¯ `failed` çŠ¶æ…‹ã§è¨˜éŒ²ã•ã‚Œã‚‹

**Deliverable:**
- ãƒãƒ£ãƒ³ã‚¯ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ï¼ˆã‚­ãƒ¥ãƒ¼ç®¡ç†ãƒ»ãƒªãƒˆãƒ©ã‚¤ä»˜ãï¼‰
- ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰çŠ¶æ…‹ã®IndexedDBè¨˜éŒ²

---

#### Phase 2A-5-4: RemoteStorageStrategyå®Ÿè£…ã¨çµ±åˆ

**Goal:** Remote Modeç”¨ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸æˆ¦ç•¥ã‚’å®Ÿè£…ã—ã€å…±é€šUIã§å‹•ä½œã•ã›ã‚‹

**Tasks:**
- [ ] `RemoteStorageStrategy.ts` å®Ÿè£…
  - `onRecordingStart()`: RecordingManager.createRecording() ã‚’å‘¼ã³å‡ºã—
  - `onChunkGenerated()`:
    - OPFSä¿å­˜ï¼ˆãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼‰
    - ChunkUploader.uploadChunk() å‘¼ã³å‡ºã—ï¼ˆéåŒæœŸï¼‰
  - `onRecordingStop()`: å…¨ãƒãƒ£ãƒ³ã‚¯ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Œäº†ã‚’å¾…æ©Ÿ
  - `getUploadProgress()`: ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰é€²æ—ã‚’è¿”ã™
- [ ] App.tsx ã§ `/remote` ãƒ«ãƒ¼ãƒˆã‚’æ›´æ–°
  - MainLayout + Sidebar ã‚’ä½¿ç”¨ï¼ˆ`/solo` ã¨åŒã˜æ§‹é€ ï¼‰
  - Recorderã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã« `RemoteStorageStrategy` ã‚’æ³¨å…¥
- [ ] Recorder.tsx ã§ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰é€²æ—ã‚’è¡¨ç¤º
  - StatsPanel ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰é€²æ—ã‚’è¿½åŠ 
  - ã€ŒUploaded: 15/20 chunksã€ã®ã‚ˆã†ãªè¡¨ç¤º
- [ ] ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼æ™‚ã®å‡¦ç†
  - ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¤±æ•—æ™‚ã‚‚éŒ²ç”»ç¶™ç¶šï¼ˆOPFSä¿å­˜ã®ã¿ï¼‰
  - UIä¸Šã§çŠ¶æ…‹ã‚’è¡¨ç¤ºï¼ˆä¾‹: ã€Œâš ï¸ Upload paused - Recording continues locallyã€ï¼‰
- [ ] éŒ²ç”»åœæ­¢æ™‚ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Œäº†å¾…æ©ŸUI
  - ã€ŒFinalizing upload...ã€ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤º
  - ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼è¡¨ç¤º

**Test:**

**åŸºæœ¬ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆ:**
- [ ] `/remote` ã«ã‚¢ã‚¯ã‚»ã‚¹ â†’ `/solo` ã¨åŒã˜UIãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] MainLayout + Sidebar ãŒå…±é€šã§ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹
- [ ] éŒ²ç”»é–‹å§‹ â†’ ã‚µãƒ¼ãƒãƒ¼ã«RecordingãŒè‡ªå‹•ä½œæˆã•ã‚Œã‚‹
- [ ] éŒ²ç”»ä¸­ã€ãƒãƒ£ãƒ³ã‚¯ãŒOPFSã¨ã‚µãƒ¼ãƒãƒ¼ã«ä¸¦è¡Œä¿å­˜ã•ã‚Œã‚‹
- [ ] ã‚µãƒ¼ãƒãƒ¼ã® `./storage/{recording_id}/` ã«ãƒãƒ£ãƒ³ã‚¯ãŒéšæ™‚ä¿å­˜ã•ã‚Œã‚‹
- [ ] UIã«ã€ŒUploaded: 15/20 chunksã€ã®ã‚ˆã†ãªé€²æ—ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] éŒ²ç”»åœæ­¢ â†’ ã€ŒFinalizing upload...ã€ãƒ¢ãƒ¼ãƒ€ãƒ«ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] å…¨ãƒãƒ£ãƒ³ã‚¯ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Œäº†ã‚’å¾…ã¤
- [ ] å®Œäº†å¾Œã€RecordingçŠ¶æ…‹ãŒ`synced`ã«ãªã‚‹
- [ ] ã‚µãƒ¼ãƒãƒ¼å´ã§Recordingæƒ…å ±ã‚’ç¢ºèª
  ```bash
  curl http://localhost:3000/api/recordings/{recording_id}
  # ãƒ¬ã‚¹ãƒãƒ³ã‚¹: {"state": "synced", "chunk_count": 20, ...}
  ```

**ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆ:**
- [ ] éŒ²ç”»ä¸­ã«ã‚µãƒ¼ãƒãƒ¼ã‚’åœæ­¢
  - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºãŒå¤‰ã‚ã‚‹ï¼ˆä¾‹: ã€Œâš ï¸ Upload pausedã€ï¼‰
  - éŒ²ç”»ã¯ç¶™ç¶šã•ã‚Œã‚‹
  - OPFSã«ã¯ãƒãƒ£ãƒ³ã‚¯ãŒä¿å­˜ã•ã‚Œã‚‹
  - å¤±æ•—ã—ãŸãƒãƒ£ãƒ³ã‚¯ãŒIndexedDBã«è¨˜éŒ²ã•ã‚Œã‚‹
- [ ] ã‚µãƒ¼ãƒãƒ¼ã‚’å†èµ·å‹•
  - UIçŠ¶æ…‹ãŒæ›´æ–°ã•ã‚Œã‚‹
  - ï¼ˆPhase 3ã§è‡ªå‹•å†é€å®Ÿè£…äºˆå®šï¼‰

**UIå…±é€šåŒ–ãƒ†ã‚¹ãƒˆ:**
- [ ] `/solo` ã¨ `/remote` ãŒåŒã˜UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½¿ç”¨
- [ ] Sidebar, MainHeader, VideoPreview, StatsPanel, ControlPanel ãŒå…±é€š
- [ ] `/solo` ã«ã‚¢ã‚¯ã‚»ã‚¹ â†’ Standalone Modeç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] Standalone Modeã§éŒ²ç”» â†’ ã‚µãƒ¼ãƒãƒ¼ã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãªã—
- [ ] `/remote` ã«åˆ‡ã‚Šæ›¿ãˆ â†’ Remote Modeç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] ä¸¡ãƒ¢ãƒ¼ãƒ‰ãŒç‹¬ç«‹ã—ã¦å‹•ä½œã™ã‚‹

**Deliverable:**
- **Remote Modeï¼ˆãƒªãƒ¢ãƒ¼ãƒˆãƒ¢ãƒ¼ãƒ‰ï¼‰ã®å®Œå…¨å®Ÿè£…**
  - `/solo` ã¨ `/remote` ã§æ˜ç¢ºã«ãƒ¢ãƒ¼ãƒ‰åˆ†é›¢
  - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒãƒ£ãƒ³ã‚¯ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½
  - OPFS + ã‚µãƒ¼ãƒãƒ¼ã®äºŒé‡ä¿å­˜ã‚·ã‚¹ãƒ†ãƒ 
  - ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼è€æ€§ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«éŒ²ç”»ç¶™ç¶šï¼‰
  - Recordingãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†ã®å®Œå…¨ãªçµ±åˆ
- **UIå®Œå…¨å…±é€šåŒ–**
  - Recorder, MainLayout, Sidebar, ãã®ä»–å…¨UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å…±æœ‰
  - ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸æˆ¦ç•¥ã®ã¿ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ã‚¯ãƒªãƒ¼ãƒ³ãªè¨­è¨ˆ
  - ä¸¡ãƒ¢ãƒ¼ãƒ‰ã§ä¸€è²«ã—ãŸUX
  - ä¿å®ˆæ€§ãƒ»æ‹¡å¼µæ€§ã®å‘ä¸Š

---

### Phase 2A-6: ãƒãƒƒã‚·ãƒ¥æ¤œè¨¼ãƒ»å†ªç­‰æ€§å®Ÿè£…

**Goal:** ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ã¨ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã®å†ªç­‰æ€§ã‚’ä¿è¨¼

**Tasks:**
- [ ] ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ãƒãƒ£ãƒ³ã‚¯ã®Blake3ãƒãƒƒã‚·ãƒ¥è¨ˆç®—
  - blake3 WebAssemblyãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ç”¨
- [ ] ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ãƒãƒƒã‚·ãƒ¥ã‚’å«ã‚ã‚‹
  - ãƒ˜ãƒƒãƒ€ãƒ¼: `X-Chunk-Hash: <blake3-hash>`
- [ ] ã‚µãƒ¼ãƒãƒ¼å´ã§ãƒãƒƒã‚·ãƒ¥æ¤œè¨¼ï¼ˆTypeScriptï¼‰
  - blake3 npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ãƒãƒƒã‚·ãƒ¥è¨ˆç®—
  - ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰é€ä¿¡ã•ã‚ŒãŸãƒãƒƒã‚·ãƒ¥ã¨æ¯”è¼ƒ
  - ä¸ä¸€è‡´ã®å ´åˆã¯ `400 Bad Request` ã‚’è¿”ã™
- [ ] å†ªç­‰æ€§å®Ÿè£…
  - æ—¢ã«å­˜åœ¨ã™ã‚‹ãƒãƒ£ãƒ³ã‚¯ã®å ´åˆã€ãƒãƒƒã‚·ãƒ¥æ¯”è¼ƒã—ã¦åŒä¸€ãªã‚‰ `200 OK` ã‚’è¿”ã™
  - ãƒãƒƒã‚·ãƒ¥ãŒç•°ãªã‚‹å ´åˆã¯ `409 Conflict` ã‚’è¿”ã™
- [ ] IndexedDBã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ¸ˆã¿ãƒãƒ£ãƒ³ã‚¯ã®ãƒãƒƒã‚·ãƒ¥ã‚’è¨˜éŒ²

**Test:**
- [ ] ãƒãƒ£ãƒ³ã‚¯ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰â†’æˆåŠŸ
- [ ] åŒã˜ãƒãƒ£ãƒ³ã‚¯ã‚’å†åº¦ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰â†’`200 OK`ï¼ˆå†ªç­‰æ€§ç¢ºèªï¼‰
- [ ] ãƒãƒƒã‚·ãƒ¥ã‚’æ”¹ã–ã‚“ã—ã¦ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰â†’`400 Bad Request`
- [ ] ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ã§é€”ä¸­å¤±æ•—â†’å†é€ä¿¡ã§æ­£å¸¸ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Œäº†

**Deliverable:**
- ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ãŒä¿è¨¼ã•ã‚ŒãŸã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½
- å†é€æ™‚ã®å®‰å…¨æ€§ç¢ºä¿

---

### Phase 2A-7: ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½å®Ÿè£…

**Goal:** ã‚µãƒ¼ãƒãƒ¼ã«ä¿å­˜ã•ã‚ŒãŸRecordingã®ãƒãƒ£ãƒ³ã‚¯ã‚’çµåˆã—ã¦MP4ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

**Concept:**
- ã‚µãƒ¼ãƒãƒ¼å´ã§ãƒãƒ£ãƒ³ã‚¯ã‚’ã‚¹ãƒˆãƒªãƒ¼ãƒ çµåˆã—ã¦MP4ã¨ã—ã¦é…ä¿¡
- ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ï¼ˆRemote Modeå®Œäº†ç”»é¢ï¼‰ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ã‚’è¿½åŠ 
- ãƒ¡ãƒ¢ãƒªåŠ¹ç‡çš„ãªå®Ÿè£…ï¼ˆå¤§å®¹é‡å‹•ç”»å¯¾å¿œï¼‰

**Tasks:**

**ã‚µãƒ¼ãƒãƒ¼å´:**
- [ ] `GET /api/recordings/:recording_id/download` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…
  - Recordingå­˜åœ¨ç¢ºèª
  - RecordingçŠ¶æ…‹ãŒ `synced` ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª
  - ãƒãƒ£ãƒ³ã‚¯ä¸€è¦§ã‚’å–å¾—ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰ï¼‰
  - ãƒãƒ£ãƒ³ã‚¯ã‚’é †ç•ªã«èª­ã¿å‡ºã—ã¦ã‚¹ãƒˆãƒªãƒ¼ãƒ çµåˆ
  - `Content-Type: video/mp4` ã§è¿”å´
  - `Content-Disposition: attachment; filename="recording-{id}.mp4"`
- [ ] ã‚¹ãƒˆãƒªãƒ¼ãƒ å‡¦ç†å®Ÿè£…
  - ãƒãƒ£ãƒ³ã‚¯ã‚’1ã¤ãšã¤èª­ã¿å‡ºã—
  - `ReadableStream` ã‚’ä½¿ã£ã¦ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«æ›¸ãè¾¼ã¿
  - ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã‚’æœ€å°åŒ–
- [ ] Range Requestå¯¾å¿œï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«ï¼‰
  - éƒ¨åˆ†ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¯¾å¿œ
  - `Accept-Ranges: bytes` ãƒ˜ãƒƒãƒ€ãƒ¼
  - å¤§å®¹é‡ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ¬ã‚¸ãƒ¥ãƒ¼ãƒ å¯¾å¿œ

**ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´:**
- [ ] Remote Modeå®Œäº†ç”»é¢ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³è¿½åŠ 
- [ ] ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å‡¦ç†å®Ÿè£…
  - `fetch('/api/recordings/{id}/download')`
  - ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’Blobã¨ã—ã¦å–å¾—
  - `URL.createObjectURL()` ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ç”Ÿæˆ
  - è‡ªå‹•ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰é–‹å§‹
- [ ] ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰é€²æ—è¡¨ç¤ºï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«ï¼‰
  - ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºè¡¨ç¤º
  - é€²æ—ãƒãƒ¼è¡¨ç¤º

**UI:**
- [ ] Remote Modeå®Œäº†ç”»é¢ã®æ›´æ–°
  ```
  âœ“ Recording synced to server
  Recording ID: {recording_id}

  [Download MP4] â† æ–°è¦è¿½åŠ 
  [New Recording]
  ```
- [ ] ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ä¸­ã®è¡¨ç¤º
  ```
  Downloading... (12.5 MB / 45.2 MB)
  [Progress bar â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 27%
  ```

**Test:**
- [ ] Recordingä½œæˆãƒ»ãƒãƒ£ãƒ³ã‚¯ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Œäº†
- [ ] RecordingçŠ¶æ…‹ãŒ`synced`ã«ãªã‚‹
- [ ] ã€ŒDownload MP4ã€ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯
- [ ] MP4ãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã‚‹
- [ ] ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸMP4ã‚’VLCã§å†ç”Ÿã§ãã‚‹
- [ ] å‹•ç”»ãƒ»éŸ³å£°ãŒæ­£å¸¸ã«å†ç”Ÿã•ã‚Œã‚‹
- [ ] è¤‡æ•°ã®Recordingï¼ˆç•°ãªã‚‹é•·ã•ï¼‰ã§ãƒ†ã‚¹ãƒˆ
- [ ] å¤§å®¹é‡Recordingï¼ˆ1GBä»¥ä¸Šï¼‰ã§ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ç¢ºèª

**Error Handling:**
- [ ] Recordingæœªå­˜åœ¨: `404 Not Found`
- [ ] RecordingçŠ¶æ…‹ãŒ`synced`ã§ãªã„: `400 Bad Request` (ã€Œã¾ã åŒæœŸä¸­ã§ã™ã€)
- [ ] ãƒãƒ£ãƒ³ã‚¯ãƒ•ã‚¡ã‚¤ãƒ«ç ´æ: ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°å‡ºåŠ›ã€é©åˆ‡ãªã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹

**Deliverable:**
- Recording MP4ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½
- ã‚µãƒ¼ãƒãƒ¼å´ã‚¹ãƒˆãƒªãƒ¼ãƒ çµåˆå‡¦ç†
- ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰UI

---

**Overall Phase 2 (2A-1 ~ 2A-7) Deliverable:**
- **å®Œå…¨ãªãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ï¼ˆRemote Modeï¼‰**
  - **2ã¤ã®ãƒ¢ãƒ¼ãƒ‰å®Ÿè£…:**
    - Standalone Mode (`/solo`): Phase 1å®Ÿè£…ã€ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
    - **Remote Mode (`/remote`)**: Phase 2å®Ÿè£…ã€ã‚µãƒ¼ãƒãƒ¼é€£æºã€ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
  - **Recordingç®¡ç†API**ï¼ˆä½œæˆã€å–å¾—ã€çŠ¶æ…‹æ›´æ–°ï¼‰
  - ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒéŒ²ç”»é–‹å§‹å‰ã«Recording IDã‚’å–å¾—
  - **éŒ²ç”»ä¸­ã«ãƒãƒ£ãƒ³ã‚¯ã‚’éšæ™‚ã‚µãƒ¼ãƒãƒ¼ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰**ï¼ˆOPFS + ã‚µãƒ¼ãƒãƒ¼ã®äºŒé‡ä¿å­˜ï¼‰
  - ãƒãƒƒã‚·ãƒ¥æ¤œè¨¼ã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ä¿è¨¼
  - å†ªç­‰æ€§ã«ã‚ˆã‚Šå®‰å…¨ãªå†é€ãŒå¯èƒ½
  - ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã«ãƒãƒ£ãƒ³ã‚¯ãŒæ­£å¸¸ã«ä¿å­˜ã•ã‚Œã‚‹
  - Recordingãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†ï¼ˆStandby â†’ Recording â†’ Finalizing â†’ Syncedï¼‰
  - ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼æ™‚ã‚‚ãƒ­ãƒ¼ã‚«ãƒ«éŒ²ç”»ã‚’ç¶™ç¶šï¼ˆå …ç‰¢æ€§ï¼‰
  - **Recording MP4ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½**ï¼ˆã‚µãƒ¼ãƒãƒ¼å´ã§ãƒãƒ£ãƒ³ã‚¯çµåˆï¼‰
  - **Phase 4ã®Roomæ©Ÿèƒ½ï¼ˆè¤‡æ•°Recordingç®¡ç†ï¼‰å®Ÿè£…ã«å‘ã‘ãŸåŸºç›¤æ§‹ç¯‰**

**Note:** WebSocketã«ã‚ˆã‚‹ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çŠ¶æ…‹åŒæœŸã¯Phase 4ï¼ˆRoom/Director Modeï¼‰ã§å®Ÿè£…ã—ã¾ã™ã€‚Phase 2ã®Remote Modeã§ã¯å˜ä¸€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ãŸã‚ã€HTTP APIã®ã¿ã§ååˆ†ã§ã™ã€‚

---

## Phase 3: å …ç‰¢æ€§æ©Ÿèƒ½å®Ÿè£…

**Goal:** ã€Œå¤±æ•—ã—ãªã„ã€ãŸã‚ã®4å±¤é˜²å¾¡ã‚’å®Œæˆã•ã›ã‚‹

### 3.1 Manifest & Verification

**Tasks:**
- [ ] `@maycast/common-types`ã«Manifestå‹å®šç¾©
- [ ] ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§Recordingã”ã¨ã«Chunkãƒãƒƒã‚·ãƒ¥ãƒªã‚¹ãƒˆç”Ÿæˆ
- [ ] ã‚µãƒ¼ãƒãƒ¼å´ã§å—ä¿¡Chunkã¨ãƒãƒƒã‚·ãƒ¥ç…§åˆ
- [ ] ä¸è¶³Chunkã®æ¤œå‡ºã¨NACKãƒ—ãƒ­ãƒˆã‚³ãƒ«
- [ ] Recordingå®Œäº†æ™‚ã®Manifestæ¤œè¨¼

### 3.2 Resume Upload æ©Ÿèƒ½

**Tasks:**
- [ ] OPFSã‹ã‚‰æœªé€ä¿¡Chunkã‚’æ¤œå‡º
- [ ] ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§å†é€ä¿¡
- [ ] é€²æ—è¡¨ç¤ºUI

### 3.3 Delta Syncï¼ˆå·®åˆ†åŒæœŸï¼‰

**Tasks:**
- [ ] ã‚µãƒ¼ãƒãƒ¼å´ã§ç¾åœ¨ã®Chunkãƒªã‚¹ãƒˆã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«è¿”ã™
- [ ] ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒå·®åˆ†ã‚’æ¤œå‡ºã—ã¦é€ä¿¡
- [ ] ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åˆ‡æ–­â†’å¾©æ—§ã‚·ãƒŠãƒªã‚ªã®ãƒ†ã‚¹ãƒˆ

### 3.4 Crash Recovery

**Tasks:**
- [ ] ãƒ–ãƒ©ã‚¦ã‚¶å†èµ·å‹•å¾Œã€OPFSå†…ã®æœªå®Œäº†Recordingã‚’æ¤œå‡º
- [ ] ã€Œå‰å›ã®åéŒ²ã‚’å¾©å…ƒã—ã¾ã™ã‹ï¼Ÿã€UI
- [ ] Standalone Mode: ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½
- [ ] Remote Mode: è‡ªå‹•å†ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆRecording IDç¶­æŒï¼‰

**Deliverable:**
- é›»æºæ–­ã€ãƒ–ãƒ©ã‚¦ã‚¶ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã€å›ç·šåˆ‡æ–­ã«è€ãˆã‚‹ã‚·ã‚¹ãƒ†ãƒ 
- ã™ã¹ã¦ã®ãƒ¢ãƒ¼ãƒ‰ã§ãƒ‡ãƒ¼ã‚¿æå¤±ã‚¼ãƒ­ã‚’ä¿è¨¼

---

## Phase 4: Roomæ©Ÿèƒ½ãƒ»Director Mode å®Ÿè£… ğŸ¯

**Goal:** è¤‡æ•°ã®ã‚²ã‚¹ãƒˆRecordingã‚’Roomã§æŸã­ã€ç®¡ç†è€…ãŒä¸€æ‹¬åˆ¶å¾¡ã§ãã‚‹ä»•çµ„ã¿ã‚’æ§‹ç¯‰

**Concept:**
- **Room**: è¤‡æ•°Recordingã‚’æŸã­ã‚‹åéŒ²ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼ˆPhase 4ã§æ–°è¦å®Ÿè£…ï¼‰
- Directorï¼ˆç®¡ç†è€…ï¼‰ãŒRoomã‚’ä½œæˆã—ã€Guest URLã‚’é…å¸ƒ
- ã‚²ã‚¹ãƒˆã¯URLã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦éŒ²ç”»é–‹å§‹ï¼ˆPhase 2ã®Remote ModeæŠ€è¡“ã‚’æ´»ç”¨ï¼‰
- åŒä¸€Roomå†…ã®ã™ã¹ã¦ã®Recordingã‚’ä¸€æ‹¬ç®¡ç†

**Hierarchy:**
```
Room (room-abc123)
 â”œâ”€ Recording A (Guest A: recording-001)
 â”œâ”€ Recording B (Guest B: recording-002)
 â””â”€ Recording C (Guest C: recording-003)
```

---

### Phase 4.1: Roomç®¡ç†APIå®Ÿè£…

**Goal:** Roomã®ä½œæˆãƒ»å–å¾—ãƒ»çŠ¶æ…‹ç®¡ç†APIã‚’å®Ÿè£…

**Storage Structure:**
```text
/storage
â””â”€â”€ /rooms
    â””â”€â”€ /{room_id}/
        â”œâ”€â”€ /{recording_id_1}/  # Guest A
        â”‚   â”œâ”€â”€ chunk-001.fmp4
        â”‚   â””â”€â”€ ...
        â”œâ”€â”€ /{recording_id_2}/  # Guest B
        â”‚   â””â”€â”€ ...
        â””â”€â”€ /{recording_id_3}/  # Guest C
            â””â”€â”€ ...

Roomãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ï¼ˆã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªMapï¼‰:
rooms: Map<room_id, Room>

interface Room {
  id: string;              // UUID
  state: RoomState;        // 'standby' | 'recording' | 'finalizing' | 'synced'
  createdAt: Date;
  startedAt?: Date;
  finishedAt?: Date;
  recordings: string[];    // Recording IDã®ãƒªã‚¹ãƒˆ
  guestUrl: string;        // Guestç”¨ã®URL
}
```

**Tasks:**
- [ ] Roomãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«å®šç¾©ï¼ˆTypeScriptï¼‰
- [ ] Roomã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å®Ÿè£…ï¼ˆã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªMapï¼‰
  - `rooms: Map<string, Room>`
  - Phase 7ã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ç§»è¡Œäºˆå®š
- [ ] `POST /api/rooms` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…
  - æ–°ã—ã„Roomã‚’ä½œæˆ
  - UUIDã§Room IDç”Ÿæˆ
  - Guest URLç”Ÿæˆï¼ˆä¾‹: `/guest/{room_id}`ï¼‰
  - åˆæœŸçŠ¶æ…‹ã¯ `standby`
  - ãƒ¬ã‚¹ãƒãƒ³ã‚¹: `{ room_id, guest_url, created_at, state }`
- [ ] `GET /api/rooms/:room_id` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…
  - Roomæƒ…å ±ã‚’å–å¾—
  - å«ã¾ã‚Œã‚‹Recordingä¸€è¦§ã‚‚è¿”ã™
- [ ] `PATCH /api/rooms/:room_id/state` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…
  - RoomçŠ¶æ…‹ã‚’æ›´æ–°
  - Roomå†…ã®å…¨RecordingçŠ¶æ…‹ã‚‚é€£å‹•ã—ã¦æ›´æ–°
- [ ] `GET /api/rooms/:room_id/recordings` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…
  - Roomå†…ã®ã™ã¹ã¦ã®Recordingã‚’å–å¾—

**Test:**
- [ ] curlã§Roomä½œæˆ
  ```bash
  curl -X POST http://localhost:3000/api/rooms
  # ãƒ¬ã‚¹ãƒãƒ³ã‚¹: {"room_id": "room-abc123", "guest_url": "/guest/room-abc123", ...}
  ```
- [ ] Roomæƒ…å ±å–å¾—
  ```bash
  curl http://localhost:3000/api/rooms/room-abc123
  ```

**Deliverable:**
- Roomç®¡ç†API
- Recording â†’ Roomã®ç´ä»˜ã‘æ©Ÿèƒ½

---

### Phase 4.2: Recording APIæ‹¡å¼µï¼ˆRoomå¯¾å¿œï¼‰

**Goal:** Recordingä½œæˆæ™‚ã«Room IDã‚’æŒ‡å®šã§ãã‚‹ã‚ˆã†ã«æ‹¡å¼µ

**Tasks:**
- [ ] `POST /api/recordings` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆæ‹¡å¼µ
  - ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ `?room_id=xxx` ã‚’å—ã‘å–ã‚‹
  - room_idãŒæŒ‡å®šã•ã‚ŒãŸå ´åˆã€Recordingã«ç´ä»˜ã‘
  - Room ã® recordingsé…åˆ—ã«è¿½åŠ 
  - ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ‘ã‚¹: `./storage/rooms/{room_id}/{recording_id}/`
- [ ] Recordingä½œæˆæ™‚ã«Roomå­˜åœ¨ç¢ºèª
  - Roomæœªå­˜åœ¨ã®å ´åˆã¯ `404 Not Found`
  - RoomçŠ¶æ…‹ãŒ `standby` ã¾ãŸã¯ `recording` ã§ãªã„å ´åˆã¯ `400 Bad Request`

**Test:**
- [ ] Roomä½œæˆå¾Œã€Recordingä½œæˆ
  ```bash
  ROOM_ID=$(curl -X POST http://localhost:3000/api/rooms | jq -r '.room_id')
  RECORDING_ID=$(curl -X POST "http://localhost:3000/api/recordings?room_id=$ROOM_ID" | jq -r '.recording_id')
  ```
- [ ] ãƒãƒ£ãƒ³ã‚¯ãŒ `./storage/rooms/{room_id}/{recording_id}/` ã«ä¿å­˜ã•ã‚Œã‚‹
- [ ] Roomæƒ…å ±å–å¾—æ™‚ã€recordingsã«å«ã¾ã‚Œã‚‹

**Deliverable:**
- Roomå¯¾å¿œRecordingä½œæˆAPI

---

### Phase 4.3: Guest Modeå®Ÿè£…

**Goal:** ã‚²ã‚¹ãƒˆç”¨ã®éŒ²ç”»ç”»é¢ã‚’å®Ÿè£…ï¼ˆRemote Modeãƒ™ãƒ¼ã‚¹ã§Roomå¯¾å¿œï¼‰

**URL Structure:**
```
/guest/{room_id}
```

**Project Structure:**
```text
/packages/web-client/src
â””â”€â”€ /modes
    â”œâ”€â”€ /standalone
    â”œâ”€â”€ /remote
    â””â”€â”€ /guest          # Phase 4ã§è¿½åŠ 
        â”œâ”€â”€ GuestRecorder.tsx
        â”œâ”€â”€ RoomConnection.ts
        â””â”€â”€ ...
```

**Tasks:**
- [ ] `/guest/:room_id` ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¿½åŠ 
- [ ] `GuestRecorder.tsx` ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…
  - URLã‹ã‚‰room_idã‚’å–å¾—
  - Roomå­˜åœ¨ç¢ºèªï¼ˆ`GET /api/rooms/:room_id`ï¼‰
  - Recordingä½œæˆæ™‚ã«room_idã‚’æŒ‡å®š
  - Remote Modeã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’å†åˆ©ç”¨
- [ ] `RoomConnection.ts` å®Ÿè£…
  - Room WebSocketæ¥ç¶šï¼ˆ`/ws/rooms/:room_id`ï¼‰
  - RoomçŠ¶æ…‹å¤‰æ›´ã®å—ä¿¡
  - DirectoræŒ‡ç¤ºï¼ˆRECé–‹å§‹/åœæ­¢ï¼‰ã®å—ä¿¡

**UI:**
- [ ] Remote Modeã¨åŒæ§˜ã®éŒ²ç”»UI
- [ ] Room IDã¨éŒ²ç”»çŠ¶æ…‹è¡¨ç¤º
- [ ] ã€ŒWaiting for director...ã€å¾…æ©Ÿç”»é¢
- [ ] DirectoræŒ‡ç¤ºã«ã‚ˆã‚‹RECé–‹å§‹/åœæ­¢ï¼ˆæ‰‹å‹•æ“ä½œä¸å¯ï¼‰

**Test:**
- [ ] DirectorãŒRoomã‚’ä½œæˆ
- [ ] Guest URLã«ã‚¢ã‚¯ã‚»ã‚¹
- [ ] å¾…æ©Ÿç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] DirectorãŒéŒ²ç”»é–‹å§‹ã‚’æŒ‡ç¤ºï¼ˆPhase 4.4ã§å®Ÿè£…ï¼‰
- [ ] ã‚²ã‚¹ãƒˆå´ã§è‡ªå‹•çš„ã«éŒ²ç”»é–‹å§‹

**Deliverable:**
- Guest Modeç”»é¢
- Roomé€£æºæ©Ÿèƒ½

---

### Phase 4.4: Directorç”»é¢å®Ÿè£…

**Goal:** ç®¡ç†è€…ç”¨ã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’å®Ÿè£…ã—ã€Roomä½œæˆãƒ»ä¸€æ‹¬åˆ¶å¾¡ã‚’å¯èƒ½ã«ã™ã‚‹

**URL Structure:**
```
/director
```

**Project Structure:**
```text
/packages/web-client/src
â””â”€â”€ /modes
    â””â”€â”€ /director       # Phase 4ã§è¿½åŠ 
        â”œâ”€â”€ DirectorDashboard.tsx
        â”œâ”€â”€ RoomManager.ts
        â”œâ”€â”€ RoomControls.tsx
        â””â”€â”€ ...
```

**Tasks:**
- [ ] `/director` ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¿½åŠ 
- [ ] `DirectorDashboard.tsx` ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…
  - Roomä¸€è¦§è¡¨ç¤º
  - æ–°è¦Roomä½œæˆãƒœã‚¿ãƒ³
  - Roomè©³ç´°ãƒ“ãƒ¥ãƒ¼
- [ ] `RoomControls.tsx` ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…
  - Guest URLè¡¨ç¤ºãƒ»ã‚³ãƒ”ãƒ¼æ©Ÿèƒ½
  - ã€ŒStart Recordingã€ãƒœã‚¿ãƒ³
  - ã€ŒStop Recordingã€ãƒœã‚¿ãƒ³
  - æ¥ç¶šä¸­ã®ã‚²ã‚¹ãƒˆä¸€è¦§
  - å„ã‚²ã‚¹ãƒˆã®éŒ²ç”»çŠ¶æ…‹è¡¨ç¤º
- [ ] `RoomManager.ts` å®Ÿè£…
  - Roomä½œæˆï¼ˆ`POST /api/rooms`ï¼‰
  - RoomçŠ¶æ…‹æ›´æ–°ï¼ˆ`PATCH /api/rooms/:id/state`ï¼‰
  - Room WebSocketæ¥ç¶š

**UI:**
- [ ] Roomä¸€è¦§ç”»é¢
  - ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªRoomä¸€è¦§
  - å„Roomã®çŠ¶æ…‹è¡¨ç¤º
- [ ] Roomè©³ç´°ç”»é¢
  - Guest URLè¡¨ç¤ºï¼ˆã‚³ãƒ”ãƒ¼ãƒœã‚¿ãƒ³ä»˜ãï¼‰
  - æ¥ç¶šä¸­ã®ã‚²ã‚¹ãƒˆä¸€è¦§
    - Guest A: ğŸŸ¢ Recording (15/20 chunks)
    - Guest B: ğŸŸ¢ Recording (12/20 chunks)
    - Guest C: ğŸ”´ Disconnected
  - ä¸€æ‹¬åˆ¶å¾¡ãƒœã‚¿ãƒ³
    - ã€ŒStart Recording Allã€
    - ã€ŒStop Recording Allã€
  - å…¨ã‚²ã‚¹ãƒˆã®åŒæœŸçŠ¶æ…‹è¡¨ç¤º

**Test:**
- [ ] Directorç”»é¢ã«ã‚¢ã‚¯ã‚»ã‚¹
- [ ] æ–°è¦Roomä½œæˆ
- [ ] Guest URLãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] Guest URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¦åˆ¥ã‚¿ãƒ–ã§é–‹ã
- [ ] ã‚²ã‚¹ãƒˆãŒæ¥ç¶šã•ã‚Œã‚‹ï¼ˆDirectorç”»é¢ã«è¡¨ç¤ºï¼‰
- [ ] ã€ŒStart Recording Allã€ã‚¯ãƒªãƒƒã‚¯
- [ ] å…¨ã‚²ã‚¹ãƒˆã§éŒ²ç”»é–‹å§‹
- [ ] ã€ŒStop Recording Allã€ã‚¯ãƒªãƒƒã‚¯
- [ ] å…¨ã‚²ã‚¹ãƒˆã§éŒ²ç”»åœæ­¢ãƒ»åŒæœŸå®Œäº†

**Deliverable:**
- Directorç”»é¢
- Roomä¸€æ‹¬åˆ¶å¾¡æ©Ÿèƒ½

---

### Phase 4.5: Room WebSocketå®Ÿè£…

**Goal:** Roomå˜ä½ã§ã®WebSocketé€šä¿¡ã‚’å®Ÿè£…ã—ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çŠ¶æ…‹åŒæœŸ

**Note:** Phase 2ã®Remote Modeã§ã¯å˜ä¸€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ãŸã‚ã€WebSocketã¯ä¸è¦ã§ã—ãŸï¼ˆHTTP APIã®ã¿ã§ååˆ†ï¼‰ã€‚Phase 4ã§ã¯è¤‡æ•°ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆDirector + Guestsï¼‰é–“ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡ãŒå¿…è¦ãªãŸã‚ã€ã“ã“ã§åˆã‚ã¦WebSocketã‚’å°å…¥ã—ã¾ã™ã€‚

**Tasks:**
- [ ] `/ws/rooms/:room_id` WebSocketã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…
- [ ] Roomå†…ã®å…¨æ¥ç¶šã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ç®¡ç†
  - Directoræ¥ç¶š
  - Guestæ¥ç¶šï¼ˆè¤‡æ•°ï¼‰
- [ ] RoomçŠ¶æ…‹å¤‰æ›´ã®ãƒ–ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ£ã‚¹ãƒˆ
  - `RoomStateChanged { room_id, state }`
  - `RecordingCreated { room_id, recording_id, guest_name }`
  - `RecordingStateChanged { room_id, recording_id, state }`
  - `ChunkUploaded { room_id, recording_id, chunk_id }`
- [ ] DirectoræŒ‡ç¤ºã®ãƒ–ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ£ã‚¹ãƒˆ
  - `DirectorCommand { command: 'start' | 'stop' }`
  - Roomå†…ã®å…¨Guestã«é€ä¿¡

**Test:**
- [ ] Directorã¨Guestï¼ˆè¤‡æ•°ï¼‰ãŒåŒã˜Roomã«æ¥ç¶š
- [ ] DirectorãŒã€ŒStartã€æŒ‡ç¤º â†’ å…¨Guestã«é€šçŸ¥ãŒå±Šã
- [ ] GuestéŒ²ç”»é–‹å§‹ â†’ Directorã«çŠ¶æ…‹å¤‰æ›´é€šçŸ¥ãŒå±Šã
- [ ] Guestãƒãƒ£ãƒ³ã‚¯ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ â†’ Directorã«ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€²æ—è¡¨ç¤º

**Deliverable:**
- Roomå˜ä½ã®WebSocketé€šä¿¡
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çŠ¶æ…‹åŒæœŸ

---

### Phase 4.6: Stop & Flush Protocol

**Goal:** éŒ²ç”»åœæ­¢æ™‚ã€å…¨ã‚²ã‚¹ãƒˆã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Œäº†ã‚’å¾…æ©Ÿã™ã‚‹ä»•çµ„ã¿

**Tasks:**
- [ ] Directorã€ŒStopã€æŒ‡ç¤ºæ™‚ã®å‡¦ç†
  1. RoomçŠ¶æ…‹ã‚’ `finalizing` ã«æ›´æ–°
  2. å…¨Guestã«StopæŒ‡ç¤ºã‚’ãƒ–ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ£ã‚¹ãƒˆ
  3. å„GuestãŒéŒ²ç”»åœæ­¢
  4. æœªé€ä¿¡ãƒãƒ£ãƒ³ã‚¯ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Œäº†ã‚’å¾…æ©Ÿ
  5. å„RecordingãŒSyncedçŠ¶æ…‹ã«ãªã‚‹ã®ã‚’ç›£è¦–
  6. å…¨Recording Syncedç¢ºèªå¾Œã€RoomçŠ¶æ…‹ã‚’ `synced` ã«æ›´æ–°
- [ ] Guestå´ã®å‡¦ç†
  - StopæŒ‡ç¤ºå—ä¿¡
  - éŒ²ç”»åœæ­¢
  - æœªé€ä¿¡ãƒãƒ£ãƒ³ã‚¯å®Œäº†å¾…æ©Ÿ
  - `synced`çŠ¶æ…‹ã«æ›´æ–°
  - WebSocketæ¥ç¶šç¶­æŒï¼ˆã€Œãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‰ã˜ã¦OKã€ã¾ã§ï¼‰
- [ ] Directorå´ã®è¡¨ç¤º
  - ã€ŒWaiting for all guests to sync...ã€
  - å„ã‚²ã‚¹ãƒˆã®åŒæœŸçŠ¶æ…‹è¡¨ç¤º
  - å…¨å“¡Syncedå¾Œã€Œâœ“ All recordings syncedã€

**Test:**
- [ ] è¤‡æ•°ã‚²ã‚¹ãƒˆã§éŒ²ç”»ä¸­
- [ ] Directorã€ŒStopã€ã‚¯ãƒªãƒƒã‚¯
- [ ] å…¨ã‚²ã‚¹ãƒˆã§éŒ²ç”»åœæ­¢
- [ ] å„ã‚²ã‚¹ãƒˆã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Œäº†ã‚’å¾…æ©Ÿ
- [ ] å…¨ã‚²ã‚¹ãƒˆSyncedç¢ºèª
- [ ] RoomçŠ¶æ…‹ãŒ`synced`ã«ãªã‚‹
- [ ] ã‚²ã‚¹ãƒˆç”»é¢ã«ã€Œãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‰ã˜ã¦OKã€è¡¨ç¤º

**Deliverable:**
- Stop & Flushãƒ—ãƒ­ãƒˆã‚³ãƒ«
- å…¨ã‚²ã‚¹ãƒˆåŒæœŸç¢ºèªæ©Ÿèƒ½

---

### Phase 4.7: Directorç”»é¢ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½

**Goal:** Directorç”»é¢ã‹ã‚‰å„Recordingï¼ˆGuestï¼‰ã®MP4ã‚’å€‹åˆ¥ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

**Concept:**
- Phase 2A-7ã§å®Ÿè£…ã—ãŸãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’æ´»ç”¨
- Directorç”»é¢ã§å„Guestã®éŒ²ç”»ã‚’å€‹åˆ¥ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¯èƒ½
- ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼šå…¨Recordingä¸€æ‹¬ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆZIPå½¢å¼ï¼‰

**Tasks:**

**Directorç”»é¢UI:**
- [ ] Roomè©³ç´°ç”»é¢ã«å„Recordingã®MP4ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ã‚’è¿½åŠ 
  ```
  Room: room-abc123
  Status: âœ“ Synced

  Recordings:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Guest A (recording-001)                 â”‚
  â”‚ Duration: 15:32                         â”‚
  â”‚ Size: 1.2 GB                            â”‚
  â”‚ [Download MP4]                          â”‚ â† æ–°è¦è¿½åŠ 
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Guest B (recording-002)                 â”‚
  â”‚ Duration: 15:30                         â”‚
  â”‚ Size: 1.1 GB                            â”‚
  â”‚ [Download MP4]                          â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Guest C (recording-003)                 â”‚
  â”‚ Duration: 15:35                         â”‚
  â”‚ Size: 1.3 GB                            â”‚
  â”‚ [Download MP4]                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  [Download All as ZIP] â† ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«
  ```

- [ ] ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯æ™‚ã®å‡¦ç†
  - `GET /api/recordings/{recording_id}/download` ã‚’å‘¼ã³å‡ºã—
  - ãƒ•ã‚¡ã‚¤ãƒ«åã‚’ `{room_id}_{guest_name}_{timestamp}.mp4` ã«è¨­å®š
  - è‡ªå‹•ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰é–‹å§‹

- [ ] ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰é€²æ—è¡¨ç¤º
  - å„Recordingã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰çŠ¶æ…‹ã‚’è¡¨ç¤º
  - è¤‡æ•°ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ™‚ã®ã‚­ãƒ¥ãƒ¼ç®¡ç†

**ã‚µãƒ¼ãƒãƒ¼å´ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«ï¼‰:**
- [ ] `GET /api/rooms/:room_id/download-all` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«ï¼‰
  - Roomå†…ã®å…¨Recordingã‚’å–å¾—
  - å„Recordingã‚’MP4ã«çµåˆ
  - ZIPå½¢å¼ã§åœ§ç¸®
  - ZIPå…¨ä½“ã‚’ã‚¹ãƒˆãƒªãƒ¼ãƒ é…ä¿¡
  - ãƒ•ã‚¡ã‚¤ãƒ«å: `room-{room_id}.zip`

**Test:**
- [ ] Directorç”»é¢ã§Roomä½œæˆâ†’è¤‡æ•°GuestéŒ²ç”»â†’å…¨å“¡Synced
- [ ] Guest Aã®MP4ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
  - ãƒ•ã‚¡ã‚¤ãƒ«å: `room-abc123_guest-a_20260122-143052.mp4`
  - VLCã§å†ç”Ÿã§ãã‚‹
- [ ] Guest Bã®MP4ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
  - æ­£å¸¸ã«å†ç”Ÿã§ãã‚‹
- [ ] è¤‡æ•°RecordingåŒæ™‚ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
  - ãƒ–ãƒ©ã‚¦ã‚¶ãŒè¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
- [ ] ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«ï¼‰ã€ŒDownload All as ZIPã€
  - ZIPå†…ã«å…¨Guestã®MP4ãŒå«ã¾ã‚Œã‚‹
  - å„MP4ãŒæ­£å¸¸ã«å†ç”Ÿã§ãã‚‹

**UIæ”¹å–„:**
- [ ] Recordingæƒ…å ±è¡¨ç¤º
  - Durationï¼ˆéŒ²ç”»æ™‚é–“ï¼‰è¡¨ç¤º
  - File Sizeï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºï¼‰è¡¨ç¤º
  - Recording Stateï¼ˆçŠ¶æ…‹ï¼‰è¡¨ç¤º
- [ ] ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰çŠ¶æ…‹ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼
  - ğŸ”µ Download ready
  - ğŸŸ¢ Downloading...
  - âœ… Downloaded

**Deliverable:**
- Directorç”»é¢ã‹ã‚‰å„Recording MP4ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
- Gueståˆ¥ã®ãƒ•ã‚¡ã‚¤ãƒ«åã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
- ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«ï¼‰å…¨Recordingä¸€æ‹¬ZIPãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

---

**Overall Phase 4 Deliverable:**
- **å®Œå…¨ãªRoomç®¡ç†ãƒ»Director Modeå®Ÿè£…**
  - Roomä½œæˆãƒ»ç®¡ç†API
  - Directorç”»é¢ï¼ˆ`/director`ï¼‰
  - Guest Modeï¼ˆ`/guest/{room_id}`ï¼‰
  - è¤‡æ•°Recordingã®ä¸€æ‹¬ç®¡ç†
  - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çŠ¶æ…‹åŒæœŸï¼ˆWebSocketï¼‰
  - Stop & Flushãƒ—ãƒ­ãƒˆã‚³ãƒ«
  - å…¨ã‚²ã‚¹ãƒˆåŒæœŸç¢ºèªæ©Ÿèƒ½
  - **Directorç”»é¢ã‹ã‚‰å„Recording MP4ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**
- **3ã¤ã®ãƒ¢ãƒ¼ãƒ‰å®Œæˆ:**
  - Standalone Mode (`/solo`): ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ã€ãƒ­ãƒ¼ã‚«ãƒ«MP4ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
  - Remote Mode (`/remote`): å˜ä¸€Recordingã€ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰MP4ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
  - **Director/Guest Mode**: è¤‡æ•°Recordingä¸€æ‹¬ç®¡ç†ã€Directorç”»é¢ã‹ã‚‰å„Guest MP4ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

---

## Phase 5: Guardian & ç›£è¦–æ©Ÿèƒ½

**Goal:** ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰è² è·ç›£è¦–ã¨è‡ªå‹•ç”»è³ªèª¿æ•´

### 5.1 Performance Monitorï¼ˆWASMå´ï¼‰

**Tasks:**
- [ ] VideoEncoder queueã‚µã‚¤ã‚ºç›£è¦–
- [ ] CPUä½¿ç”¨ç‡æ¨å®šï¼ˆå‡¦ç†é…å»¶ã‹ã‚‰ç®—å‡ºï¼‰
- [ ] å±é™ºé–¾å€¤æ¤œå‡º

### 5.2 Adaptive Bitrate

**Tasks:**
- [ ] ãƒ“ãƒƒãƒˆãƒ¬ãƒ¼ãƒˆå‹•çš„å¤‰æ›´API
- [ ] è§£åƒåº¦ãƒ€ã‚¦ãƒ³ã‚¹ã‚±ãƒ¼ãƒ«
- [ ] UIè­¦å‘Šè¡¨ç¤ºï¼ˆã€Œè² è·è»½æ¸›ã®ãŸã‚ç”»è³ªã‚’ä¸‹ã’ã¾ã—ãŸã€ï¼‰

### 5.3 Audio Analysis

**Tasks:**
- [ ] RMS/Peak ãƒ¬ãƒ™ãƒ«å–å¾—
- [ ] ç„¡éŸ³æ¤œå‡ºï¼ˆãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ç”¨ï¼‰
- [ ] ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ¡ãƒ¼ã‚¿ãƒ¼è¡¨ç¤º

**Deliverable:**
- åéŒ²åœæ­¢ã‚’é˜²ãè‡ªå‹•é˜²è¡›æ©Ÿèƒ½

---

## Phase 6: UI/UX æ”¹å–„ & ãƒãƒªãƒƒã‚·ãƒ¥

**Goal:** ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ¬ãƒ‡ã‚£ãªUIã‚’æ§‹ç¯‰ã—ã€UXã‚’æ´—ç·´

**Note:** Phase 4ã§Director/Guestç”»é¢ã®åŸºæœ¬æ©Ÿèƒ½ã¯å®Ÿè£…æ¸ˆã¿ã€‚Phase 6ã§ã¯ã•ã‚‰ãªã‚‹æ”¹å–„ã¨ãƒãƒªãƒƒã‚·ãƒ¥ã‚’è¡Œã†ã€‚

### 6.1 Directorç”»é¢ã®æ”¹å–„

**Tasks:**
- [ ] Roomä¸€è¦§ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãƒ»æ¤œç´¢æ©Ÿèƒ½
- [ ] Roomå±¥æ­´ç®¡ç†ï¼ˆéå»ã®Roomä¸€è¦§ï¼‰
- [ ] åéŒ²çµ±è¨ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
  - Roomåˆ¥ã®éŒ²ç”»æ™‚é–“
  - Gueståˆ¥ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º
  - Chunkæ•°ã€ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰é€Ÿåº¦
- [ ] ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ãƒ“ãƒ¥ãƒ¼ã‚¢
- [ ] Guestæ‹›å¾…ãƒªãƒ³ã‚¯ã®QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆ

### 6.2 Guestç”»é¢ã®æ”¹å–„

**Tasks:**
- [ ] ã‚«ãƒ¡ãƒ©/ãƒã‚¤ã‚¯äº‹å‰ãƒã‚§ãƒƒã‚¯ç”»é¢
  - ãƒ‡ãƒã‚¤ã‚¹é¸æŠ
  - ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç¢ºèª
  - éŸ³å£°ãƒ¬ãƒ™ãƒ«ãƒ¡ãƒ¼ã‚¿ãƒ¼
- [ ] æ¥ç¶šçŠ¶æ…‹ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ã®æ”¹å–„
  - ã‚ˆã‚Šè©³ç´°ãªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º
  - å†æ¥ç¶šæ™‚ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
- [ ] ã€ŒåéŒ²ä¸­ã€ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
- [ ] SyncedçŠ¶æ…‹ã®æ˜ç¢ºãªè¡¨ç¤º
  - æˆåŠŸã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
  - ã€Œãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‰ã˜ã¦OKã€ã®å¤§ããªè¡¨ç¤º

### 6.3 Download æ©Ÿèƒ½

**Tasks:**
- [ ] ã‚µãƒ¼ãƒãƒ¼å´ã§Chunkã‚’ã‚¹ãƒˆãƒªãƒ¼ãƒ çµåˆ
- [ ] `GET /api/recordings/:id/download` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
- [ ] `GET /api/rooms/:id/download` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆå…¨Recordingçµåˆï¼‰
- [ ] Range Requestå¯¾å¿œï¼ˆéƒ¨åˆ†ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼‰
- [ ] ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰é€²æ—è¡¨ç¤º

### 6.4 å…¨ãƒ¢ãƒ¼ãƒ‰å…±é€šUIæ”¹å–„

**Tasks:**
- [ ] ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³å¯¾å¿œ
- [ ] ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰å®Œå…¨å¯¾å¿œï¼ˆTailwind CSSè¨­å®šï¼‰
- [ ] ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£æ”¹å–„ï¼ˆARIAå±æ€§ã€ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
- [ ] ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ”¹å–„
- [ ] ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³çµ±ä¸€

**Deliverable:**
- ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ¬ãƒ‡ã‚£ãªUI/UX
- å…¨ãƒ¢ãƒ¼ãƒ‰ã§çµ±ä¸€ã•ã‚ŒãŸæ“ä½œä½“é¨“

---

## Phase 7: Enterprise æ©Ÿèƒ½ & SaaS æº–å‚™

**Goal:** Maycast Cloud / Enterprise Editionã®æº–å‚™

### 7.1 Cloud Storage çµ±åˆ

**Tasks:**
- [ ] Cloudflare R2ãƒ‰ãƒ©ã‚¤ãƒãƒ¼å®Ÿè£…
- [ ] AWS S3ãƒ‰ãƒ©ã‚¤ãƒãƒ¼å®Ÿè£…
- [ ] ç’°å¢ƒå¤‰æ•°ã«ã‚ˆã‚‹åˆ‡ã‚Šæ›¿ãˆ

### 7.2 èªè¨¼ãƒ»èªå¯

**Tasks:**
- [ ] JWTãƒ™ãƒ¼ã‚¹èªè¨¼
- [ ] Room/Recordingæ‰€æœ‰æ¨©æ¤œè¨¼
- [ ] ãƒãƒ¼ãƒ /ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†
- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ãƒ«ç®¡ç†ï¼ˆDirector, Guest, Adminï¼‰

### 7.3 Multi-Tenancy

**Tasks:**
- [ ] ãƒ†ãƒŠãƒ³ãƒˆåˆ†é›¢ï¼ˆã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ‘ã‚¹ã€DBï¼‰
- [ ] ä½¿ç”¨é‡ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°

### 7.4 Observability

**Tasks:**
- [ ] OpenTelemetryçµ±åˆ
- [ ] ãƒ¡ãƒˆãƒªã‚¯ã‚¹ï¼ˆã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰é€Ÿåº¦ã€ã‚¨ãƒ©ãƒ¼ç‡ï¼‰
- [ ] SLAç›£è¦–

**Deliverable:**
- Community Editionã‹ã‚‰ã®ç§»è¡Œãƒ‘ã‚¹æ•´å‚™
- SaaSãƒ­ãƒ¼ãƒ³ãƒæº–å‚™å®Œäº†

---

## Development Principles

1. **Incremental Delivery:** å„ãƒ•ã‚§ãƒ¼ã‚ºã¯ç‹¬ç«‹ã—ã¦å‹•ä½œã™ã‚‹çŠ¶æ…‹ã§å®Œäº†
2. **Test First:** Phase 1ã‹ã‚‰å˜ä½“ãƒ†ã‚¹ãƒˆ + E2Eãƒ†ã‚¹ãƒˆã‚’å°å…¥
3. **Documentation:** APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã€ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³ã‚’éšæ™‚æ›´æ–°
4. **Performance:** Phase 1ã‹ã‚‰ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°ï¼ˆWebCodecs, WASM, OPFSï¼‰
5. **Security:** å…¥åŠ›æ¤œè¨¼ã€CORSã€CSPã‚’åˆæœŸæ®µéšã‹ã‚‰è€ƒæ…®
6. **Taskfileç®¡ç†:** å…¨ã¦ã®é–‹ç™ºã‚³ãƒãƒ³ãƒ‰ã‚’ `Taskfile.yml` ã«é›†ç´„
   - ãƒ“ãƒ«ãƒ‰ã€ãƒ†ã‚¹ãƒˆã€é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•ãªã©ã€å…¨ã¦ã®ã‚³ãƒãƒ³ãƒ‰ã¯ `task` çµŒç”±ã§å®Ÿè¡Œ
   - `task --list` ã§å¸¸ã«åˆ©ç”¨å¯èƒ½ãªã‚³ãƒãƒ³ãƒ‰ã‚’ç¢ºèªå¯èƒ½
   - ãƒãƒ¼ãƒ å…¨ä½“ã§çµ±ä¸€ã•ã‚ŒãŸã‚³ãƒãƒ³ãƒ‰ä½“ç³»ã‚’ç¶­æŒ

---

## Success Metrics

| Phase | æˆåŠŸæŒ‡æ¨™ |
|-------|---------|
| Phase 1A-1 | **ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å®Œæˆ**<br>â€¢ Cargo Workspace ãŒæ­£å¸¸ã«ãƒ“ãƒ«ãƒ‰ã§ãã‚‹<br>â€¢ WASM ãŒæ­£å¸¸ã«ãƒ“ãƒ«ãƒ‰ã§ãã€ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰å‘¼ã³å‡ºã›ã‚‹<br>â€¢ Vite dev server ãŒèµ·å‹•ã—ã€åŸºæœ¬çš„ãªReact UIãŒè¡¨ç¤ºã•ã‚Œã‚‹ |
| Phase 1A-2 | **WebCodecs ã‚«ãƒ¡ãƒ©ã‚­ãƒ£ãƒ—ãƒãƒ£å®Œæˆ**<br>â€¢ ã‚«ãƒ¡ãƒ©æ˜ åƒãŒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«è¡¨ç¤ºã•ã‚Œã‚‹<br>â€¢ EncodedVideoChunk/AudioChunk ãŒã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›ã•ã‚Œã‚‹<br>â€¢ 1ç§’ã”ã¨ã«ã‚­ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ ãŒç”Ÿæˆã•ã‚Œã‚‹ |
| Phase 1A-3 | **WASM Muxer å˜ä½“å®Œæˆ**<br>â€¢ Rustå˜ä½“ãƒ†ã‚¹ãƒˆã§fMP4ãŒç”Ÿæˆã§ãã‚‹<br>â€¢ ç”Ÿæˆã•ã‚ŒãŸfMP4ã‚’ `mp4info` ã§æ¤œè¨¼ã§ãã‚‹<br>â€¢ WASMãƒ“ãƒ«ãƒ‰å¾Œã€ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰å‘¼ã³å‡ºã›ã‚‹ |
| Phase 1A-4 | **WebCodecs + WASM çµ±åˆå®Œæˆ**<br>â€¢ éŒ²ç”»ä¸­ã€å®šæœŸçš„ã«fMP4ãƒãƒ£ãƒ³ã‚¯ãŒç”Ÿæˆã•ã‚Œã‚‹<br>â€¢ ç”Ÿæˆã•ã‚ŒãŸãƒãƒ£ãƒ³ã‚¯ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã€VLCç­‰ã§å†ç”Ÿã§ãã‚‹<br>â€¢ å‹•ç”»ã¨éŸ³å£°ãŒæ­£ã—ãåŒæœŸã—ã¦ã„ã‚‹ |
| Phase 1A-5 | **OPFS ä¿å­˜æ©Ÿèƒ½å®Œæˆ**<br>â€¢ ãƒãƒ£ãƒ³ã‚¯ãŒOPFSã«æ­£å¸¸ã«ä¿å­˜ã•ã‚Œã‚‹<br>â€¢ ãƒ–ãƒ©ã‚¦ã‚¶ãƒªãƒ­ãƒ¼ãƒ‰å¾Œã‚‚ãƒ‡ãƒ¼ã‚¿ãŒä¿æŒã•ã‚Œã‚‹<br>â€¢ IndexedDBã«ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãè¨˜éŒ²ã•ã‚Œã‚‹ |
| Phase 1A-6 | **Phase 1A å…¨ä½“å®Œæˆ**<br>â€¢ 10åˆ†ã®éŒ²ç”»ãŒæˆåŠŸã—ã€OPFSã«æ­£å¸¸ãªfMP4ãƒãƒ£ãƒ³ã‚¯ãŒä¿å­˜ã•ã‚Œã‚‹<br>â€¢ å€‹åˆ¥ãƒãƒ£ãƒ³ã‚¯ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã€VLCç­‰ã§å†ç”Ÿã§ãã‚‹<br>â€¢ é€£ç¶šã™ã‚‹è¤‡æ•°ã®ãƒãƒ£ãƒ³ã‚¯ã‚’é †æ¬¡å†ç”Ÿã§ãã‚‹ |
| Phase 1B | **ã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ³ãƒ¢ãƒ¼ãƒ‰å®Œæˆ**<br>â€¢ Phase 1A ã®å€‹åˆ¥ãƒãƒ£ãƒ³ã‚¯ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ãŒå‰Šé™¤ã•ã‚Œã¦ã„ã‚‹<br>â€¢ ãƒãƒ£ãƒ³ã‚¯çµåˆã«ã‚ˆã‚Šå®Œå…¨ãª.mp4ãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹<br>â€¢ ãƒ–ãƒ©ã‚¦ã‚¶å¼·åˆ¶çµ‚äº†å¾Œã€ãƒªã‚«ãƒãƒªãƒ¼UIã§å¾©å…ƒã§ãã‚‹<br>â€¢ è¨­å®šå¤‰æ›´ï¼ˆãƒ‡ãƒã‚¤ã‚¹ã€ç”»è³ªï¼‰ãŒæ­£å¸¸ã«æ©Ÿèƒ½ã™ã‚‹ |
| Phase 1.5 | **TypeScriptç§»è¡Œãƒ»æ§‹é€ æœ€é©åŒ–å®Œæˆ**<br>â€¢ commonãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒTypeScriptã«ç§»è¡Œã•ã‚Œã¦ã„ã‚‹<br>â€¢ npm workspacesã§ä¸€å…ƒç®¡ç†ã•ã‚Œã¦ã„ã‚‹<br>â€¢ web-clientã‹ã‚‰`@maycast/common-types`ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã§ãã‚‹<br>â€¢ Phase 1ã®å…¨æ©Ÿèƒ½ãŒå¼•ãç¶šãæ­£å¸¸ã«å‹•ä½œã™ã‚‹ |
| Phase 2A-1 | **ã‚µãƒ¼ãƒãƒ¼ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å®Œæˆ**<br>â€¢ `task build:server` ãŒæˆåŠŸã™ã‚‹<br>â€¢ `task dev:server` ã§ã‚µãƒ¼ãƒãƒ¼ãŒèµ·å‹•ã™ã‚‹<br>â€¢ `/health` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ |
| Phase 2A-2 | **Recordingç®¡ç†APIå®Œæˆ**<br>â€¢ curlã§Recordingã‚’ä½œæˆã§ãã‚‹<br>â€¢ Recordingæƒ…å ±ã‚’å–å¾—ã§ãã‚‹<br>â€¢ RecordingçŠ¶æ…‹ã‚’æ›´æ–°ã§ãã‚‹<br>â€¢ çŠ¶æ…‹é·ç§»ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãŒå‹•ä½œã™ã‚‹ |
| Phase 2A-3 | **ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸åŸºç›¤å®Œæˆ**<br>â€¢ ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã§å…¨ãƒ†ã‚¹ãƒˆãŒæˆåŠŸã™ã‚‹<br>â€¢ ãƒãƒ£ãƒ³ã‚¯ã®æ›¸ãè¾¼ã¿ãƒ»èª­ã¿å‡ºã—ãƒ»å‰Šé™¤ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹<br>â€¢ `listChunks()` ã§ãƒãƒ£ãƒ³ã‚¯ä¸€è¦§ã‚’å–å¾—ã§ãã‚‹ |
| Phase 2A-4 | **Chunk Upload API åŸºæœ¬å®Ÿè£…å®Œæˆ**<br>â€¢ Recordingæ¤œè¨¼ä»˜ãã§ãƒãƒ£ãƒ³ã‚¯ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹<br>â€¢ ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒãƒ£ãƒ³ã‚¯ãŒãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã«ä¿å­˜ã•ã‚Œã‚‹<br>â€¢ Recordingã®chunk_countãŒæ›´æ–°ã•ã‚Œã‚‹<br>â€¢ GETã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ãƒãƒ£ãƒ³ã‚¯ã‚’å–å¾—ã§ãã‚‹ |
| Phase 2A-5-1 | **ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸æˆ¦ç•¥ãƒ‘ã‚¿ãƒ¼ãƒ³å°å…¥å®Œæˆ**<br>â€¢ IStorageStrategyã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©<br>â€¢ StandaloneStorageStrategyã«æ—¢å­˜ãƒ­ã‚¸ãƒƒã‚¯æŠ½å‡º<br>â€¢ Recorderã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«æˆ¦ç•¥æ³¨å…¥<br>â€¢ `/solo` ãŒä»¥å‰ã¨åŒã˜ã‚ˆã†ã«å‹•ä½œã™ã‚‹ |
| Phase 2A-5-2 | **Remote ModeåŸºç›¤å®Œæˆ**<br>â€¢ RecordingManagerå®Ÿè£…ï¼ˆcreateRecording, updateStateç­‰ï¼‰<br>â€¢ ã‚µãƒ¼ãƒãƒ¼URLè¨­å®šUIï¼ˆSettingsç”»é¢çµ±åˆï¼‰<br>â€¢ ã‚µãƒ¼ãƒãƒ¼æ¥ç¶šç¢ºèªæ©Ÿèƒ½<br>â€¢ CORSè¨­å®šå®Œäº† |
| Phase 2A-5-3 | **ãƒãƒ£ãƒ³ã‚¯ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½å®Œæˆ**<br>â€¢ ChunkUploaderã‚¯ãƒ©ã‚¹å®Ÿè£…<br>â€¢ ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ¥ãƒ¼ç®¡ç†ï¼ˆæœ€å¤§3ä¸¦åˆ—ï¼‰<br>â€¢ è‡ªå‹•ãƒªãƒˆãƒ©ã‚¤æ©Ÿèƒ½ï¼ˆæœ€å¤§3å›ï¼‰<br>â€¢ IndexedDBã«çŠ¶æ…‹è¨˜éŒ² |
| Phase 2A-5-4 | **Remote Modeå®Œå…¨çµ±åˆãƒ»UIå…±é€šåŒ–å®Œæˆ**<br>â€¢ RemoteStorageStrategyå®Ÿè£…<br>â€¢ `/remote` ãŒ `/solo` ã¨åŒã˜UIã‚’ä½¿ç”¨<br>â€¢ éŒ²ç”»ä¸­ã€ãƒãƒ£ãƒ³ã‚¯ãŒOPFSã¨ã‚µãƒ¼ãƒãƒ¼ã«ä¸¦è¡Œä¿å­˜ã•ã‚Œã‚‹<br>â€¢ éŒ²ç”»åœæ­¢æ™‚ã€å…¨ãƒãƒ£ãƒ³ã‚¯ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Œäº†ã‚’å¾…ã¤<br>â€¢ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼æ™‚ã‚‚éŒ²ç”»ãŒç¶™ç¶šã•ã‚Œã‚‹<br>â€¢ ä¸¡ãƒ¢ãƒ¼ãƒ‰ãŒç‹¬ç«‹ã—ã¦å‹•ä½œã™ã‚‹ |
| Phase 2A-6 | **ãƒãƒƒã‚·ãƒ¥æ¤œè¨¼ãƒ»å†ªç­‰æ€§å®Ÿè£…å®Œæˆ**<br>â€¢ Blake3ãƒãƒƒã‚·ãƒ¥æ¤œè¨¼ãŒå‹•ä½œã™ã‚‹<br>â€¢ åŒã˜ãƒãƒ£ãƒ³ã‚¯ã‚’å†åº¦ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ã‚‚æ­£å¸¸ã«å‡¦ç†ã•ã‚Œã‚‹ï¼ˆå†ªç­‰æ€§ï¼‰<br>â€¢ ãƒãƒƒã‚·ãƒ¥æ”¹ã–ã‚“æ™‚ã«ã‚¨ãƒ©ãƒ¼ãŒè¿”ã‚‹ |
| Phase 2A-7 | **ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½å®Œæˆ**<br>â€¢ ã‚µãƒ¼ãƒãƒ¼å´ã§ãƒãƒ£ãƒ³ã‚¯ã‚’ã‚¹ãƒˆãƒªãƒ¼ãƒ çµåˆã§ãã‚‹<br>â€¢ `GET /api/recordings/:id/download` ã§MP4ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹<br>â€¢ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸMP4ãŒæ­£å¸¸ã«å†ç”Ÿã§ãã‚‹<br>â€¢ **Phase 2å®Œäº†ï¼šRemote Modeå®Œå…¨å®Ÿè£…** |
| Phase 3 | ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åˆ‡æ–­ãƒ»å¾©æ—§ã‚·ãƒŠãƒªã‚ªã§0ãƒã‚¤ãƒˆã®ãƒ‡ãƒ¼ã‚¿æå¤± |
| Phase 4 | **Room/Director Modeå®Œæˆ**<br>â€¢ DirectorãŒ Roomã‚’ä½œæˆã§ãã‚‹<br>â€¢ Guest URLã§è¤‡æ•°ã‚²ã‚¹ãƒˆãŒå‚åŠ ã§ãã‚‹<br>â€¢ 3äººã®ã‚²ã‚¹ãƒˆã‚’åŒæ™‚åˆ¶å¾¡ã—ã€å…¨å“¡ãŒã€ŒSyncedã€çŠ¶æ…‹ã«åˆ°é”<br>â€¢ Stop & Flushãƒ—ãƒ­ãƒˆã‚³ãƒ«ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ |
| Phase 5 | é«˜è² è·æ™‚ã§ã‚‚åéŒ²åœæ­¢ãŒç™ºç”Ÿã—ãªã„ |
| Phase 6 | ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆã§90%ä»¥ä¸ŠãŒã€Œä½¿ã„ã‚„ã™ã„ã€ã¨è©•ä¾¡ |
| Phase 7 | SaaSç’°å¢ƒã§24æ™‚é–“é€£ç¶šç¨¼åƒã€99.9% Uptimeé”æˆ |

---

## Timeline Guidance

å„ãƒ•ã‚§ãƒ¼ã‚ºã®æœŸé–“ã¯é–‹ç™ºä½“åˆ¶ã«ã‚ˆã‚Šå¤‰å‹•ã—ã¾ã™ãŒã€ä»¥ä¸‹ã‚’ç›®å®‰ã¨ã—ã¾ã™ã€‚

- **Phase 1A-1:** ç’°å¢ƒæ§‹ç¯‰ã€‚æ—©æœŸã«å®Œäº†ã•ã›ã‚‹
- **Phase 1A-2:** WebCodecs ã®å‹•ä½œç¢ºèªã€‚ç‹¬ç«‹ã—ã¦ãƒ†ã‚¹ãƒˆå¯èƒ½
- **Phase 1A-3:** Rust WASM Muxer ã®å®Ÿè£…ã€‚å˜ä½“ãƒ†ã‚¹ãƒˆã§å“è³ªä¿è¨¼
- **Phase 1A-4:** çµ±åˆãƒ†ã‚¹ãƒˆã€‚fMP4ãƒãƒ£ãƒ³ã‚¯ç”Ÿæˆã®æ¤œè¨¼ãŒæœ€é‡è¦
- **Phase 1A-5:** OPFSå®Ÿè£…ã€‚æ°¸ç¶šåŒ–ã®æ¤œè¨¼
- **Phase 1A-6:** ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆã€‚å…¨ä½“ãƒ•ãƒ­ãƒ¼ç¢ºèª
- **Phase 1B:** ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒ»ãƒªã‚«ãƒãƒªãƒ¼ãƒ»UIå®Œæˆã€‚Phase 1A ã‚ˆã‚ŠçŸ­æœŸé–“ã§å®Œäº†å¯èƒ½
- **Phase 1.5:** æ§‹é€ æœ€é©åŒ–ã€‚Phase 2ã¸ã®æº–å‚™ã¨ã—ã¦å‹å®šç¾©ã‚’TypeScriptã«çµ±ä¸€
- **Phase 2A-1:** ã‚µãƒ¼ãƒãƒ¼ç’°å¢ƒæ§‹ç¯‰ã€‚ExpressåŸºç›¤ã®ç¢ºç«‹
- **Phase 2A-2:** Recordingç®¡ç†APIã€‚Recordingãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã®ç¢ºç«‹
- **Phase 2A-3:** ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸åŸºç›¤ã€‚å˜ä½“ãƒ†ã‚¹ãƒˆã§å“è³ªä¿è¨¼
- **Phase 2A-4:** Upload APIå®Ÿè£…ã€‚Recordingæ¤œè¨¼ä»˜ãã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- **Phase 2A-5:** **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Ÿè£…**ã€‚UIå…±é€šåŒ–ã¨Remote Modeå®Œå…¨å®Ÿè£…ã€æœ€é‡è¦ãƒ•ã‚§ãƒ¼ã‚º
  - **Phase 2A-5-1:** ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸æˆ¦ç•¥ãƒ‘ã‚¿ãƒ¼ãƒ³å°å…¥ã€‚æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã®ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
  - **Phase 2A-5-2:** Recordingç®¡ç†é€šä¿¡å±¤ã€‚ã‚µãƒ¼ãƒãƒ¼URLè¨­å®šã¨APIé€šä¿¡
  - **Phase 2A-5-3:** ãƒãƒ£ãƒ³ã‚¯ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ã€‚ã‚­ãƒ¥ãƒ¼ç®¡ç†ãƒ»ãƒªãƒˆãƒ©ã‚¤æ©Ÿèƒ½
  - **Phase 2A-5-4:** Remote Modeçµ±åˆã€‚UIå®Œå…¨å…±é€šåŒ–ã€ä¸¦è¡Œã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Ÿç¾
- **Phase 2A-6:** ãƒãƒƒã‚·ãƒ¥æ¤œè¨¼ãƒ»å†ªç­‰æ€§ã€‚ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ã®ä¿è¨¼
- **Phase 2A-7:** ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ã€‚MP4ã‚¹ãƒˆãƒªãƒ¼ãƒ çµåˆé…ä¿¡ã€Phase 2å®Œäº†
- **Phase 3:** å …ç‰¢æ€§ã®æ ¸å¿ƒã€‚å¦¥å”ã—ãªã„
- **Phase 4:** Director Modeã¯ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã®å·®åˆ¥åŒ–è¦å› 
- **Phase 5-6:** UXã®æ´—ç·´ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ†ã‚¹ãƒˆã‚’ç¹°ã‚Šè¿”ã™
- **Phase 7:** ãƒ“ã‚¸ãƒã‚¹è¦ä»¶ã«å¿œã˜ã¦èª¿æ•´

---

## Next Steps

1. **Phase 1A-1 ã‹ã‚‰é–‹å§‹:** Cargo Workspace + Vite + WASM ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ§‹ç¯‰
   - **Taskfile.yml ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚’æœ€å„ªå…ˆã§å®Ÿæ–½**
   - ä»¥é™ã®å…¨ã¦ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ `task` çµŒç”±ã§å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹
2. **å„ã‚µãƒ–ãƒ•ã‚§ãƒ¼ã‚ºã‚’é †æ¬¡å®Œäº†:** ç‹¬ç«‹ã—ã¦ãƒ†ã‚¹ãƒˆå¯èƒ½ãªãŸã‚ã€ç¢ºå®Ÿã«é€²ã‚ã‚‹
3. **Phase 1 ã®æŠ€è¡“æ¤œè¨¼ã‚’æ—©æœŸã«å®Ÿæ–½:**
   - Phase 1A-2: WebCodecs ãŒæœŸå¾…é€šã‚Šã«å‹•ä½œã™ã‚‹ã‹
   - Phase 1A-3: Rust ã§ fMP4 ãŒæ­£ã—ãç”Ÿæˆã§ãã‚‹ã‹
   - Phase 1A-4: çµ±åˆæ™‚ã®åŒæœŸå•é¡ŒãŒãªã„ã‹
4. **Phase 1A-6 å®Œäº†æ™‚ç‚¹ã§ã€fMP4ãƒãƒ£ãƒ³ã‚¯ç”Ÿæˆã®å…¨ä½“ãƒ•ãƒ­ãƒ¼ãŒæ¤œè¨¼å®Œäº†**
5. **Phase 1B ã§ã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ³ãƒ¢ãƒ¼ãƒ‰ã‚’å®Œæˆ:**
   - ãƒãƒ£ãƒ³ã‚¯çµåˆã«ã‚ˆã‚‹MP4ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
   - ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãƒªã‚«ãƒãƒªãƒ¼æ©Ÿèƒ½
   - ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ¬ãƒ‡ã‚£ãªUI
6. **Phase 1.5 ã§æ§‹é€ ã‚’æœ€é©åŒ–:**
   - commonãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’TypeScriptã«ç§»è¡Œ
   - npm workspacesã§ãƒ¢ãƒãƒ¬ãƒç®¡ç†
   - Phase 2ã¸ã®æº–å‚™å®Œäº†
7. **Phase 2A-1 ã‹ã‚‰é–‹å§‹:** ã‚µãƒ¼ãƒãƒ¼å´åŸºç›¤æ§‹ç¯‰
   - TypeScript + Express ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
   - Taskfile.yml ã«ã‚µãƒ¼ãƒãƒ¼é–¢é€£ã‚¿ã‚¹ã‚¯è¿½åŠ 
8. **Phase 2 ã®å„ã‚µãƒ–ãƒ•ã‚§ãƒ¼ã‚ºã‚’é †æ¬¡å®Œäº†:**
   - Phase 2A-2: Recordingç®¡ç†APIã‚’å®Ÿè£…ã—ã€curlã§ãƒ†ã‚¹ãƒˆ
   - Phase 2A-3: ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸åŸºç›¤ã‚’å˜ä½“ãƒ†ã‚¹ãƒˆã§æ¤œè¨¼
   - Phase 2A-4: Upload APIã«Recordingæ¤œè¨¼ã‚’è¿½åŠ 
   - Phase 2A-5: **éŒ²ç”»ä¸­ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Ÿè£…**ï¼ˆUIå…±é€šåŒ– + OPFS + ã‚µãƒ¼ãƒãƒ¼ä¸¦è¡Œä¿å­˜ï¼‰
     - Phase 2A-5-1: ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸æˆ¦ç•¥ãƒ‘ã‚¿ãƒ¼ãƒ³å°å…¥ã€æ—¢å­˜ã‚³ãƒ¼ãƒ‰ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
     - Phase 2A-5-2: RecordingManagerãƒ»ã‚µãƒ¼ãƒãƒ¼URLè¨­å®šUIå®Ÿè£…
     - Phase 2A-5-3: ChunkUploaderå®Ÿè£…ï¼ˆã‚­ãƒ¥ãƒ¼ç®¡ç†ãƒ»ãƒªãƒˆãƒ©ã‚¤ï¼‰
     - Phase 2A-5-4: RemoteStorageStrategyçµ±åˆã€UIå®Œå…¨å…±é€šåŒ–
   - Phase 2A-6: ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ã‚’ä¿è¨¼ï¼ˆBlake3ãƒãƒƒã‚·ãƒ¥æ¤œè¨¼ãƒ»å†ªç­‰æ€§ï¼‰
   - Phase 2A-7: ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½å®Ÿè£…ï¼ˆãƒãƒ£ãƒ³ã‚¯çµåˆâ†’MP4é…ä¿¡ï¼‰
9. **Phase 2A-7 å®Œäº†æ™‚ç‚¹ã§ã€Recordingä½œæˆâ†’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰â†’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã®å®Œå…¨ãªãƒ•ãƒ­ãƒ¼ãŒæ¤œè¨¼å®Œäº†**
10. **Phase 3ä»¥é™:**
    - Phase 3: å …ç‰¢æ€§æ©Ÿèƒ½ï¼ˆManifestã€Resume Uploadã€Delta Syncï¼‰
    - Phase 4: Roomæ©Ÿèƒ½ãƒ»Director Modeï¼ˆWebSocketå®Ÿè£…ã€è¤‡æ•°Recordingç®¡ç†ã€å„Recordingã®MP4ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼‰

## æ¨å¥¨ã•ã‚Œã‚‹ Taskfile ã‚³ãƒãƒ³ãƒ‰ä½“ç³»

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã§ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¿ã‚¹ã‚¯æ§‹é€ ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

```bash
# é–‹ç™º
task dev              # é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•ï¼ˆWASMè‡ªå‹•ãƒªãƒ“ãƒ«ãƒ‰ + Vite HMRï¼‰
task dev:client       # ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ã¿èµ·å‹•
task dev:wasm         # WASMã®ã¿Watch mode

# ãƒ“ãƒ«ãƒ‰
task build            # å…¨ä½“ãƒ“ãƒ«ãƒ‰ï¼ˆWASM + ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼‰
task build:wasm       # WASMãƒ“ãƒ«ãƒ‰ï¼ˆwasm-packï¼‰
task build:client     # ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ“ãƒ«ãƒ‰ï¼ˆViteï¼‰

# ãƒ†ã‚¹ãƒˆ
task test             # å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
task test:rust        # Rustå˜ä½“ãƒ†ã‚¹ãƒˆ
task test:wasm        # WASMãƒ†ã‚¹ãƒˆï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ç’°å¢ƒï¼‰
task test:e2e         # E2Eãƒ†ã‚¹ãƒˆï¼ˆPhase 1A-6ä»¥é™ï¼‰

# ãƒªãƒ³ã‚¿ãƒ¼ãƒ»ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
task lint             # å…¨ã¦ã®Lintå®Ÿè¡Œ
task lint:rust        # cargo clippy
task lint:ts          # ESLint
task fmt              # å…¨ã¦ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå®Ÿè¡Œ
task fmt:rust         # cargo fmt
task fmt:ts           # Prettier

# ã‚¯ãƒªãƒ¼ãƒ³
task clean            # å…¨ãƒ“ãƒ«ãƒ‰æˆæœç‰©å‰Šé™¤
task clean:wasm       # WASMæˆæœç‰©å‰Šé™¤
task clean:client     # ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆæˆæœç‰©å‰Šé™¤

# ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
task deps:install     # å…¨ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
task deps:update      # ä¾å­˜é–¢ä¿‚æ›´æ–°
```
